import{j as e,e as le,b as pe,a as de,u as ce,c as xe,d as v,L as K}from"./index-BJZ-0Cup.js";import{r as u,k as me,R as ge}from"./icons-DL0PQMVt.js";import{R as he}from"./vendor-DYB3FAiG.js";import{P as w}from"./Panel-qYXn_6p-.js";const p={bgPrimary:"#0d0d1a",textPrimary:"#e8e8f0",textSecondary:"#a0a0b0",textTertiary:"#6a6a80",purpleBright:"#8b5cf6",greenBright:"#10b981",redBright:"#ef4444",border:"#2a2a45"},z=({children:r,style:s={}})=>e.jsx("div",{style:{background:"transparent",border:`1px solid ${p.border}`,padding:"24px",...s},children:r}),C=({children:r,onClick:s,variant:c="primary",disabled:a=!1,style:t={}})=>e.jsx("button",{onClick:s,disabled:a,style:{padding:"10px 20px",border:"none",cursor:a?"not-allowed":"pointer",fontFamily:"Consolas, 'IBM Plex Mono', monospace",fontSize:"12px",letterSpacing:"1px",textTransform:"uppercase",transition:"all 0.2s",opacity:a?.5:1,...c==="primary"?{background:p.purpleBright,color:"rgba(255,255,255,.94)"}:c==="danger"?{background:p.redBright,color:"rgba(255,255,255,.94)"}:{background:"transparent",border:`1px solid ${p.border}`,color:p.textSecondary},...t},children:r}),y=({label:r,value:s,onChange:c,type:a="text",placeholder:t="",style:d={}})=>e.jsxs("div",{style:{marginBottom:"12px",...d},children:[r&&e.jsx("label",{style:{display:"block",fontSize:"11px",letterSpacing:"1px",textTransform:"uppercase",color:p.textTertiary,marginBottom:"6px",fontFamily:"Consolas, 'IBM Plex Mono', monospace"},children:r}),e.jsx("input",{type:a,value:s,onChange:b=>c(a==="number"?parseFloat(b.target.value)||0:b.target.value),placeholder:t,style:{width:"100%",padding:"10px 12px",background:p.bgPrimary,border:`1px solid ${p.border}`,color:p.textPrimary,fontSize:"14px",fontFamily:"Consolas, 'IBM Plex Mono', monospace"}})]}),W=({label:r,value:s,onChange:c,options:a,style:t={}})=>e.jsxs("div",{style:{marginBottom:"12px",...t},children:[r&&e.jsx("label",{style:{display:"block",fontSize:"11px",letterSpacing:"1px",textTransform:"uppercase",color:p.textTertiary,marginBottom:"6px",fontFamily:"Consolas, 'IBM Plex Mono', monospace"},children:r}),e.jsx("select",{value:s,onChange:d=>c(d.target.value),style:{width:"100%",padding:"10px 12px",background:p.bgPrimary,border:`1px solid ${p.border}`,color:p.textPrimary,fontSize:"14px",fontFamily:"Consolas, 'IBM Plex Mono', monospace"},children:a.map(d=>e.jsx("option",{value:d.value,children:d.label},d.value))})]}),ue=({boundary:r,onChange:s,onRemove:c})=>e.jsxs(z,{style:{marginBottom:"12px",padding:"16px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[e.jsx("span",{style:{color:p.purpleBright,fontSize:"12px",fontFamily:"Consolas, 'IBM Plex Mono', monospace"},children:"NUMERIC BOUNDARY"}),e.jsx(C,{variant:"danger",onClick:c,style:{padding:"4px 12px",fontSize:"10px"},children:"Remove"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[e.jsx(y,{label:"Name",value:r.name||"",onChange:a=>s({...r,name:a}),placeholder:"e.g., Speed Limit"}),e.jsx(y,{label:"Parameter",value:r.parameter||"",onChange:a=>s({...r,parameter:a}),placeholder:"e.g., speed"}),e.jsx(y,{label:"Min Value",type:"number",value:r.min_value??"",onChange:a=>s({...r,min_value:a||null}),placeholder:"Optional"}),e.jsx(y,{label:"Max Value",type:"number",value:r.max_value??"",onChange:a=>s({...r,max_value:a||null}),placeholder:"Required"}),e.jsx(y,{label:"Unit",value:r.unit||"",onChange:a=>s({...r,unit:a}),placeholder:"e.g., km/h, °C"}),e.jsx(y,{label:"Tolerance",type:"number",value:r.tolerance||0,onChange:a=>s({...r,tolerance:a}),placeholder:"0"})]}),e.jsx(W,{label:"On Violation",value:r.violation_action||"block",onChange:a=>s({...r,violation_action:a}),options:[{value:"block",label:"Block Action"},{value:"warn",label:"Warn Only"},{value:"log",label:"Log Only"}],style:{marginTop:"12px",marginBottom:0}})]}),ye=({boundary:r,onChange:s,onRemove:c})=>{var a,t;return e.jsxs(z,{style:{marginBottom:"12px",padding:"16px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[e.jsx("span",{style:{color:p.greenBright,fontSize:"12px",fontFamily:"Consolas, 'IBM Plex Mono', monospace"},children:"GEOGRAPHIC BOUNDARY"}),e.jsx(C,{variant:"danger",onClick:c,style:{padding:"4px 12px",fontSize:"10px"},children:"Remove"})]}),e.jsx(y,{label:"Name",value:r.name||"",onChange:d=>s({...r,name:d}),placeholder:"e.g., Warehouse Zone"}),e.jsx(W,{label:"Boundary Type",value:r.boundary_type||"circle",onChange:d=>s({...r,boundary_type:d}),options:[{value:"circle",label:"Circle (Center + Radius)"},{value:"polygon",label:"Polygon (Multiple Points)"}]}),r.boundary_type==="circle"||!r.boundary_type?e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"12px"},children:[e.jsx(y,{label:"Center Latitude",type:"number",value:((a=r.center)==null?void 0:a.lat)??"",onChange:d=>s({...r,center:{...r.center,lat:d}}),placeholder:"30.2672"}),e.jsx(y,{label:"Center Longitude",type:"number",value:((t=r.center)==null?void 0:t.lon)??"",onChange:d=>s({...r,center:{...r.center,lon:d}}),placeholder:"-97.7431"}),e.jsx(y,{label:"Radius (meters)",type:"number",value:r.radius_meters||"",onChange:d=>s({...r,radius_meters:d}),placeholder:"1000"})]}):e.jsx("div",{style:{color:p.textSecondary,fontSize:"12px",padding:"12px",background:p.bgPrimary},children:"Polygon editor coming soon. For now, enter coordinates as JSON in the raw editor below."})]})},fe=({boundary:r,onChange:s,onRemove:c})=>e.jsxs(z,{style:{marginBottom:"12px",padding:"16px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[e.jsx("span",{style:{color:"#f59e0b",fontSize:"12px",fontFamily:"Consolas, 'IBM Plex Mono', monospace"},children:"TIME BOUNDARY"}),e.jsx(C,{variant:"danger",onClick:c,style:{padding:"4px 12px",fontSize:"10px"},children:"Remove"})]}),e.jsx(y,{label:"Name",value:r.name||"",onChange:a=>s({...r,name:a}),placeholder:"e.g., Operating Hours"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[e.jsx(y,{label:"Start Hour (0-23)",type:"number",value:r.allowed_hours_start??0,onChange:a=>s({...r,allowed_hours_start:Math.min(23,Math.max(0,a))})}),e.jsx(y,{label:"End Hour (0-23)",type:"number",value:r.allowed_hours_end??23,onChange:a=>s({...r,allowed_hours_end:Math.min(23,Math.max(0,a))})})]}),e.jsxs("div",{style:{marginTop:"12px"},children:[e.jsx("label",{style:{display:"block",fontSize:"11px",letterSpacing:"1px",textTransform:"uppercase",color:p.textTertiary,marginBottom:"8px",fontFamily:"Consolas, 'IBM Plex Mono', monospace"},children:"Allowed Days"}),e.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].map((a,t)=>{const d=r.allowed_days||[0,1,2,3,4,5,6],b=d.includes(t);return e.jsx("button",{onClick:()=>{const F=b?d.filter(_=>_!==t):[...d,t].sort();s({...r,allowed_days:F})},style:{padding:"6px 12px",border:`1px solid ${b?p.purpleBright:p.border}`,background:b?p.purpleBright:"transparent",color:b?"white":p.textSecondary,cursor:"pointer",fontSize:"12px",fontFamily:"Consolas, 'IBM Plex Mono', monospace"},children:a},a)})})]})]}),be=({boundary:r,onChange:s,onRemove:c})=>e.jsxs(z,{style:{marginBottom:"12px",padding:"16px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[e.jsx("span",{style:{color:"#ec4899",fontSize:"12px",fontFamily:"Consolas, 'IBM Plex Mono', monospace"},children:"STATE BOUNDARY"}),e.jsx(C,{variant:"danger",onClick:c,style:{padding:"4px 12px",fontSize:"10px"},children:"Remove"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[e.jsx(y,{label:"Name",value:r.name||"",onChange:a=>s({...r,name:a}),placeholder:"e.g., Operation Mode"}),e.jsx(y,{label:"Parameter",value:r.parameter||"",onChange:a=>s({...r,parameter:a}),placeholder:"e.g., mode"})]}),e.jsx(y,{label:"Allowed Values (comma-separated)",value:(r.allowed_values||[]).join(", "),onChange:a=>s({...r,allowed_values:a.split(",").map(t=>t.trim()).filter(Boolean)}),placeholder:"e.g., idle, moving, charging"}),e.jsx(y,{label:"Forbidden Values (comma-separated)",value:(r.forbidden_values||[]).join(", "),onChange:a=>s({...r,forbidden_values:a.split(",").map(t=>t.trim()).filter(Boolean)}),placeholder:"e.g., emergency, override",style:{marginBottom:0}})]});function je({applicationId:r,initialBoundaries:s,onSave:c,api:a}){var M;const[t,d]=u.useState({numeric_boundaries:[],geo_boundaries:[],time_boundaries:[],state_boundaries:[],safe_state:{action:"stop",notify:!0,log:!0},fail_closed:!0,telemetry_interval:1,heartbeat_interval:60}),[b,F]=u.useState(!1),[_,N]=u.useState(!1),[k,D]=u.useState("");u.useEffect(()=>{s&&typeof s=="object"&&d(g=>({...g,...s}))},[s]),u.useEffect(()=>{D(JSON.stringify(t,null,2))},[t]);const B=g=>{const x=`${g}_boundaries`,f={numeric:{type:"numeric",name:"",parameter:"",max_value:null,unit:"",tolerance:0,violation_action:"block"},geo:{type:"geo",name:"",boundary_type:"circle",center:{lat:0,lon:0},radius_meters:1e3,violation_action:"block"},time:{type:"time",name:"",allowed_hours_start:6,allowed_hours_end:22,allowed_days:[0,1,2,3,4],violation_action:"block"},state:{type:"state",name:"",parameter:"",allowed_values:[],forbidden_values:[],violation_action:"block"}};d(S=>({...S,[x]:[...S[x],f[g]]}))},I=(g,x,f)=>{const S=`${g}_boundaries`;d(A=>({...A,[S]:A[S].map((P,O)=>O===x?f:P)}))},R=(g,x)=>{const f=`${g}_boundaries`;d(S=>({...S,[f]:S[f].filter((A,P)=>P!==x)}))},L=async()=>{F(!0);try{await c(t)}finally{F(!1)}},j=()=>{try{const g=JSON.parse(k);d(g),N(!1)}catch(g){alert("Invalid JSON: "+g.message)}},T=t.numeric_boundaries.length+t.geo_boundaries.length+t.time_boundaries.length+t.state_boundaries.length;return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontFamily:"Consolas, 'IBM Plex Mono', monospace",fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:p.purpleBright,margin:0},children:"Boundary Configuration"}),e.jsxs("p",{style:{color:p.textSecondary,margin:"8px 0 0",fontSize:"14px"},children:[T," boundaries defined"]})]}),e.jsxs("div",{style:{display:"flex",gap:"12px"},children:[e.jsx(C,{variant:"secondary",onClick:()=>N(!_),children:_?"Visual Editor":"Raw JSON"}),e.jsx(C,{onClick:L,disabled:b,children:b?"Saving...":"Save Boundaries"})]})]}),_?e.jsxs(z,{children:[e.jsx("textarea",{value:k,onChange:g=>D(g.target.value),style:{width:"100%",minHeight:"400px",padding:"16px",background:p.bgPrimary,border:`1px solid ${p.border}`,color:p.textPrimary,fontSize:"13px",fontFamily:"Consolas, 'IBM Plex Mono', monospace",resize:"vertical"}}),e.jsx(C,{onClick:j,style:{marginTop:"12px"},children:"Apply JSON"})]}):e.jsxs("div",{children:[e.jsxs(z,{style:{marginBottom:"24px"},children:[e.jsx("p",{style:{fontSize:"11px",letterSpacing:"1px",textTransform:"uppercase",color:p.textTertiary,margin:"0 0 12px",fontFamily:"Consolas, 'IBM Plex Mono', monospace"},children:"Add Boundary"}),e.jsxs("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:[e.jsx(C,{variant:"secondary",onClick:()=>B("numeric"),children:"+ Numeric (Speed, Temp, etc.)"}),e.jsx(C,{variant:"secondary",onClick:()=>B("geo"),children:"+ Geographic (Geofence)"}),e.jsx(C,{variant:"secondary",onClick:()=>B("time"),children:"+ Time (Operating Hours)"}),e.jsx(C,{variant:"secondary",onClick:()=>B("state"),children:"+ State (Allowed Modes)"})]})]}),t.numeric_boundaries.length>0&&e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsxs("h3",{style:{color:p.textPrimary,fontSize:"14px",marginBottom:"12px"},children:["Numeric Boundaries (",t.numeric_boundaries.length,")"]}),t.numeric_boundaries.map((g,x)=>e.jsx(ue,{boundary:g,onChange:f=>I("numeric",x,f),onRemove:()=>R("numeric",x)},x))]}),t.geo_boundaries.length>0&&e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsxs("h3",{style:{color:p.textPrimary,fontSize:"14px",marginBottom:"12px"},children:["Geographic Boundaries (",t.geo_boundaries.length,")"]}),t.geo_boundaries.map((g,x)=>e.jsx(ye,{boundary:g,onChange:f=>I("geo",x,f),onRemove:()=>R("geo",x)},x))]}),t.time_boundaries.length>0&&e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsxs("h3",{style:{color:p.textPrimary,fontSize:"14px",marginBottom:"12px"},children:["Time Boundaries (",t.time_boundaries.length,")"]}),t.time_boundaries.map((g,x)=>e.jsx(fe,{boundary:g,onChange:f=>I("time",x,f),onRemove:()=>R("time",x)},x))]}),t.state_boundaries.length>0&&e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsxs("h3",{style:{color:p.textPrimary,fontSize:"14px",marginBottom:"12px"},children:["State Boundaries (",t.state_boundaries.length,")"]}),t.state_boundaries.map((g,x)=>e.jsx(be,{boundary:g,onChange:f=>I("state",x,f),onRemove:()=>R("state",x)},x))]}),e.jsxs(z,{children:[e.jsx("h3",{style:{fontSize:"11px",letterSpacing:"1px",textTransform:"uppercase",color:p.textTertiary,margin:"0 0 16px",fontFamily:"Consolas, 'IBM Plex Mono', monospace"},children:"Enforcement Settings"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"16px"},children:[e.jsx(W,{label:"On Violation",value:((M=t.safe_state)==null?void 0:M.action)||"stop",onChange:g=>d(x=>({...x,safe_state:{...x.safe_state,action:g}})),options:[{value:"stop",label:"Stop System"},{value:"reduce",label:"Reduce Operation"},{value:"handoff",label:"Human Handoff"}]}),e.jsx(W,{label:"Fail Mode",value:t.fail_closed?"closed":"open",onChange:g=>d(x=>({...x,fail_closed:g==="closed"})),options:[{value:"closed",label:"Fail Closed (Block)"},{value:"open",label:"Fail Open (Allow)"}]}),e.jsx(y,{label:"Telemetry Interval (sec)",type:"number",value:t.telemetry_interval||1,onChange:g=>d(x=>({...x,telemetry_interval:g}))})]})]}),T===0&&e.jsxs(z,{style:{textAlign:"center",padding:"48px"},children:[e.jsx("p",{style:{color:p.textSecondary,fontSize:"16px",margin:0},children:"No boundaries defined yet."}),e.jsx("p",{style:{color:p.textTertiary,fontSize:"14px",marginTop:"8px"},children:"Add boundaries above to define the system's Operational Design Domain."})]})]})]})}const m="Consolas, 'IBM Plex Mono', monospace",o={purple:"#a896d6",green:"#5CD685",red:"#D65C5C",amber:"#D6A05C",text:"rgba(255,255,255,.78)",textDim:"rgba(255,255,255,.50)",border:"rgba(255,255,255,.07)"};function ze(){const{id:r}=le(),s=pe(),{user:c}=de(),a=ce();xe();const[t,d]=u.useState(null),[b,F]=u.useState([]),[_,N]=u.useState([]),[k,D]=u.useState(""),[B,I]=u.useState(!1),[R,L]=u.useState(!1),[j,T]=u.useState(null),[M,g]=u.useState(null),[x,f]=u.useState({org_verified:!1,system_in_scope:!1,contact_valid:!1,application_complete:!1}),[S,A]=u.useState(""),[P,O]=u.useState(!1),[ve,Se]=u.useState(""),[we,Ce]=u.useState(!1);u.useEffect(()=>{r&&(v.get("/api/applications/"+r).then(n=>{d(n.data),n.data.review_checklist&&f(l=>({...l,...n.data.review_checklist}))}).catch(console.error),v.get("/api/applications/"+r+"/history").then(n=>F(n.data)).catch(console.error),v.get("/api/applications/"+r+"/comments").then(n=>N(n.data)).catch(console.error))},[r]);const H=async()=>{try{const n=await v.get("/api/applications/"+r);d(n.data);const l=await v.get("/api/applications/"+r+"/history");F(l.data)}catch(n){console.error("Refresh failed:",n)}},Y=async(n,l)=>{try{const i=await v.get("/api/applications/"+r+"/email-preview?new_state="+n);T({...i.data,label:l,newState:n})}catch{s.show("Preview failed","error")}},Q=async()=>{var n,l;if(j)try{if(await v.patch("/api/applications/"+r+"/state?new_state="+j.newState),j.newState==="approved")try{await v.post("/api/cat72/tests",{application_id:parseInt(r)}),s.show("CAT-72 test auto-scheduled","success")}catch(i){console.error("Auto-schedule CAT-72:",i.message)}T(null),await H(),s.show("State changed to "+j.newState,"success")}catch(i){s.show("Failed: "+(((l=(n=i.response)==null?void 0:n.data)==null?void 0:l.detail)||i.message),"error")}},X=()=>Y("approved","Approve Application"),Z=()=>Y("suspended","Withdraw Application"),ee=async()=>{var n,l;if(await a({title:"Reinstate",message:"Reinstate this application to pending?"}))try{await v.patch("/api/applications/"+r+"/state?new_state=pending"),await H()}catch(i){s.show("Failed: "+(((l=(n=i.response)==null?void 0:n.data)==null?void 0:l.detail)||i.message),"error")}},te=async()=>{var n,l;if(!S.trim()){s.show("Please provide a reason","error");return}if(await a({title:"Reject Application",message:"Reject this application? This will notify the applicant with your reason.",danger:!0,confirmLabel:"Reject"}))try{await v.patch("/api/applications/"+r+"/state?new_state=rejected&reason="+encodeURIComponent(S)),O(!1),A(""),await H(),s.show("Application rejected","success")}catch(i){s.show("Failed: "+(((l=(n=i.response)==null?void 0:n.data)==null?void 0:l.detail)||i.message),"error")}},oe=async()=>{var n,l;if(k.trim()){L(!0);try{const i=await v.post("/api/applications/"+r+"/comments",{content:k,is_internal:B});N(h=>[i.data,...h]),D(""),I(!1),s.show("Comment added","success")}catch(i){s.show("Failed: "+(((l=(n=i.response)==null?void 0:n.data)==null?void 0:l.detail)||i.message),"error")}L(!1)}},ne=async n=>{var l,i;try{await v.delete("/api/applications/"+r+"/comments/"+n),N(h=>h.filter(E=>E.id!==n)),s.show("Comment deleted","success")}catch(h){s.show("Failed: "+(((i=(l=h.response)==null?void 0:l.data)==null?void 0:i.detail)||h.message),"error")}};Object.values(x).every(Boolean);const $=[{key:"pending",label:"Pending",icon:"1"},{key:"approved",label:"Approved",icon:"2"},{key:"testing",label:"CAT-72",icon:"3"},{key:"conformant",label:"Certified",icon:"4"}],re=$.findIndex(n=>n.key===(t==null?void 0:t.state)),ie=(t==null?void 0:t.state)==="revoked"||(t==null?void 0:t.state)==="suspended"||(t==null?void 0:t.state)==="rejected"||(t==null?void 0:t.state)==="failed",se=()=>{switch(t==null?void 0:t.state){case"pending":return"New application. Review the organization and system, then approve or reject.";case"approved":return"Approved. Interlock credentials sent. CAT-72 auto-starts when Interlock connects.";case"testing":return"CAT-72 running. Certificate auto-issues on pass.";case"conformant":return"ODDC Conformance achieved. Certificate issued.";case"rejected":return"Application rejected. See comments for details.";case"failed":return"CAT-72 test failed. Re-approve to schedule another attempt.";case"revoked":case"suspended":return"Application withdrawn. Contact info@sentinelauthority.org.";default:return""}},ae=n=>({approved:"Approved",conformant:"Certified",pending:"Pending",testing:"CAT-72 Running",rejected:"Rejected",suspended:"Withdrawn",revoked:"Revoked",failed:"Failed"})[n]||(n||"").replace(/_/g," ");return t?e.jsxs("div",{className:"space-y-6",children:[j&&he.createPortal(e.jsx("div",{onClick:()=>T(null),style:{position:"fixed",inset:0,zIndex:99999,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,.75)",backdropFilter:"blur(4px)",WebkitBackdropFilter:"blur(4px)"},children:e.jsxs("div",{onClick:n=>n.stopPropagation(),style:{background:"rgba(18,12,30,0.95)",border:"1px solid rgba(157,140,207,0.12)",maxWidth:"min(650px, 95vw)",width:"95%",maxHeight:"80vh",overflow:"hidden",display:"flex",flexDirection:"column",position:"relative"},children:[e.jsx("span",{style:{position:"absolute",top:-1,left:-1,width:10,height:10,borderTop:"1px solid rgba(157,140,207,0.3)",borderLeft:"1px solid rgba(157,140,207,0.3)"}}),e.jsx("span",{style:{position:"absolute",top:-1,right:-1,width:10,height:10,borderTop:"1px solid rgba(157,140,207,0.3)",borderRight:"1px solid rgba(157,140,207,0.3)"}}),e.jsx("span",{style:{position:"absolute",bottom:-1,left:-1,width:10,height:10,borderBottom:"1px solid rgba(157,140,207,0.3)",borderLeft:"1px solid rgba(157,140,207,0.3)"}}),e.jsx("span",{style:{position:"absolute",bottom:-1,right:-1,width:10,height:10,borderBottom:"1px solid rgba(157,140,207,0.3)",borderRight:"1px solid rgba(157,140,207,0.3)"}}),e.jsxs("div",{style:{padding:"20px 24px",borderBottom:"1px solid rgba(255,255,255,.04)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0,fontFamily:m,fontSize:"9px",letterSpacing:"3px",textTransform:"uppercase",color:"rgba(157,140,207,0.6)"},children:"Email Preview"}),e.jsxs("p",{style:{margin:"4px 0 0",fontSize:"12px",color:o.textDim},children:["This email will be sent to ",e.jsx("strong",{style:{color:"rgba(255,255,255,.94)"},children:j.to})]})]}),e.jsx("button",{onClick:()=>T(null),style:{background:"none",border:"none",color:"rgba(255,255,255,.4)",cursor:"pointer",fontSize:"16px",padding:"4px 8px"},children:"✕"})]}),e.jsxs("div",{style:{padding:"16px 24px",borderBottom:"1px solid rgba(255,255,255,.04)"},children:[e.jsx("div",{style:{fontFamily:m,fontSize:"9px",letterSpacing:"2px",textTransform:"uppercase",color:"rgba(255,255,255,.35)",marginBottom:"4px"},children:"Subject"}),e.jsx("div",{style:{fontSize:"14px",color:"rgba(255,255,255,.94)",fontWeight:400},children:j.subject})]}),e.jsx("div",{style:{flex:1,overflow:"auto",padding:"20px 24px"},children:e.jsx("div",{style:{background:"#fff",overflow:"hidden"},dangerouslySetInnerHTML:{__html:j.html}})}),e.jsxs("div",{style:{padding:"16px 24px",display:"flex",justifyContent:"flex-end",gap:"10px",borderTop:"1px solid rgba(255,255,255,.04)"},children:[e.jsx("button",{onClick:()=>T(null),style:{padding:"8px 20px",background:"transparent",border:"1px solid rgba(255,255,255,.06)",color:"rgba(255,255,255,.5)",fontFamily:m,fontSize:"9px",letterSpacing:"1.5px",textTransform:"uppercase",cursor:"pointer"},children:"Cancel"}),e.jsxs("button",{onClick:Q,style:{padding:"8px 20px",background:"transparent",border:"1px solid "+(j.newState==="suspended"?"rgba(214,92,92,0.3)":"rgba(157,140,207,0.25)"),color:j.newState==="suspended"?o.red:"rgba(157,140,207,0.9)",fontFamily:m,fontSize:"9px",letterSpacing:"1.5px",textTransform:"uppercase",cursor:"pointer"},children:[j.label," + Send Email"]})]})]})}),document.body),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(K,{to:"/applications",className:"flex items-center gap-2 no-underline",style:{color:o.textDim,fontFamily:m,fontSize:"11px",letterSpacing:"1px",textTransform:"uppercase"},children:[e.jsx(me,{className:"w-4 h-4"})," Back to Applications"]}),(c==null?void 0:c.role)==="admin"&&e.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[t.state==="pending"&&e.jsx("button",{onClick:X,className:"px-4 py-2 btn",style:{fontSize:"11px",color:o.green,borderColor:"rgba(92,214,133,0.3)"},children:"Approve →"}),t.state==="pending"&&e.jsx("button",{onClick:()=>O(!P),className:"px-3 py-2 btn",style:{fontSize:"11px",color:o.red},children:"Reject"}),(t.state==="suspended"||t.state==="revoked"||t.state==="rejected")&&e.jsx("button",{onClick:ee,className:"px-4 py-2 btn",style:{fontSize:"11px",color:o.green,borderColor:"rgba(92,214,133,0.3)"},children:"Reinstate"}),["pending","approved"].includes(t.state)&&e.jsx("button",{onClick:Z,className:"px-3 py-2 btn",style:{fontSize:"10px",color:o.textDim,opacity:.5},children:"Withdraw"})]})]}),e.jsx(w,{children:e.jsxs("div",{style:{padding:"8px 0"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:"12px",marginBottom:"20px"},children:$.map((n,l)=>{const i=n.key===t.state,h=re>l;return e.jsxs(ge.Fragment,{children:[l>0&&e.jsx("div",{style:{flex:1,height:"2px",background:h?o.green:o.border,margin:"0 8px"}}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",minWidth:"80px"},children:[e.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontFamily:m,fontSize:"12px",fontWeight:"bold",background:h?"rgba(92,214,133,0.2)":i?"rgba(157,140,207,0.25)":"rgba(255,255,255,0.03)",border:"2px solid "+(h?o.green:i?o.purple:o.border),color:h?o.green:i?o.purple:o.textDim},children:h?"✓":n.icon}),e.jsx("span",{style:{fontFamily:m,fontSize:"9px",letterSpacing:"0.5px",textTransform:"uppercase",color:i?o.purple:h?o.green:o.textDim,textAlign:"center"},children:n.label})]})]},n.key)})}),ie&&e.jsx("div",{style:{padding:"12px 16px",border:"1px solid "+o.border,marginBottom:"12px"},children:e.jsxs("span",{style:{color:o.red,fontFamily:m,fontSize:"11px"},children:["⚠ ",t.state==="rejected"?"REJECTED":t.state==="failed"?"FAILED":"WITHDRAWN"," — See comments for details."]})}),e.jsx("div",{style:{padding:"12px 16px",border:"1px solid "+o.border},children:e.jsx("span",{style:{color:o.text,fontSize:"13px",lineHeight:"1.5"},children:se()})})]})}),M&&e.jsx("div",{style:{padding:"16px",border:"1px solid "+o.border},children:e.jsxs("p",{style:{color:o.green,fontFamily:m,fontSize:"12px",margin:0},children:["CAT-72 Test Scheduled: ",M.test_id," — ",e.jsx(K,{to:"/cat72",style:{color:o.purple},children:"Go to Console"})]})}),e.jsxs("div",{children:[e.jsxs("p",{style:{fontFamily:m,fontSize:"10px",letterSpacing:"4px",textTransform:"uppercase",color:o.purple,marginBottom:"8px"},children:["Application ",t.application_number]}),e.jsx("h1",{style:{fontFamily:"Georgia, 'Source Serif 4', serif",fontSize:"clamp(24px, 4vw, 32px)",fontWeight:200,letterSpacing:"-0.02em",margin:0},children:t.system_name}),e.jsx("p",{style:{color:o.text,marginTop:"8px"},children:t.system_description})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(w,{children:[e.jsx("div",{className:"hud-label",style:{marginBottom:"16px"},children:"Organization"}),e.jsx("p",{style:{color:"rgba(255,255,255,.94)",fontSize:"18px",marginBottom:"8px"},children:t.organization_name}),e.jsxs("p",{style:{color:o.text,marginBottom:"4px"},children:[e.jsx("strong",{children:"Contact:"})," ",t.contact_name]}),e.jsxs("p",{style:{color:o.text,marginBottom:"4px"},children:[e.jsx("strong",{children:"Email:"})," ",t.contact_email]}),t.contact_phone&&e.jsxs("p",{style:{color:o.text},children:[e.jsx("strong",{children:"Phone:"})," ",t.contact_phone]})]}),e.jsxs(w,{children:[e.jsx("div",{className:"hud-label",style:{marginBottom:"16px"},children:"Status"}),e.jsx("span",{style:{fontFamily:m,fontSize:"12px",letterSpacing:"1px",textTransform:"uppercase",color:t.state==="approved"?o.green:t.state==="rejected"||t.state==="failed"||t.state==="suspended"?o.red:o.amber},children:ae(t.state)}),e.jsxs("p",{style:{color:o.text,marginTop:"12px"},children:[e.jsx("strong",{children:"Submitted:"})," ",t.submitted_at?new Date(t.submitted_at).toLocaleString():"N/A"]})]})]}),["approved","testing","conformant"].includes(t.state)&&e.jsxs(w,{children:[e.jsx("div",{className:"hud-label",style:{marginBottom:"16px"},children:"Deploy Interlock"}),e.jsx("p",{style:{color:o.text,fontSize:"13px",marginBottom:"20px"},children:t.state==="approved"?"Your application is approved. Deploy the Interlock to begin your CAT-72 certification test.":t.state==="testing"?"CAT-72 is running. Your Interlock is connected and reporting telemetry.":"Certified. Your Interlock is actively enforcing boundaries."}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("div",{style:{fontFamily:m,fontSize:"9px",letterSpacing:"2px",textTransform:"uppercase",color:o.purple,marginBottom:"8px"},children:"Step 1 — Install"}),e.jsxs("div",{style:{background:"rgba(0,0,0,.3)",border:"1px solid "+o.border,padding:"12px 16px",fontFamily:m,fontSize:"13px",color:o.green,position:"relative"},children:[e.jsx("span",{style:{position:"absolute",top:-1,left:-1,width:8,height:8,borderTop:"1px solid rgba(157,140,207,0.3)",borderLeft:"1px solid rgba(157,140,207,0.3)"}}),e.jsx("span",{style:{position:"absolute",top:-1,right:-1,width:8,height:8,borderTop:"1px solid rgba(157,140,207,0.3)",borderRight:"1px solid rgba(157,140,207,0.3)"}}),e.jsx("span",{style:{position:"absolute",bottom:-1,left:-1,width:8,height:8,borderBottom:"1px solid rgba(157,140,207,0.3)",borderLeft:"1px solid rgba(157,140,207,0.3)"}}),e.jsx("span",{style:{position:"absolute",bottom:-1,right:-1,width:8,height:8,borderBottom:"1px solid rgba(157,140,207,0.3)",borderRight:"1px solid rgba(157,140,207,0.3)"}}),"pip install envelo"]})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("div",{style:{fontFamily:m,fontSize:"9px",letterSpacing:"2px",textTransform:"uppercase",color:o.purple,marginBottom:"8px"},children:"Step 2 — Start"}),e.jsxs("div",{style:{background:"rgba(0,0,0,.3)",border:"1px solid "+o.border,padding:"12px 16px",fontFamily:m,fontSize:"13px",color:o.green,position:"relative"},children:[e.jsx("span",{style:{position:"absolute",top:-1,left:-1,width:8,height:8,borderTop:"1px solid rgba(157,140,207,0.3)",borderLeft:"1px solid rgba(157,140,207,0.3)"}}),e.jsx("span",{style:{position:"absolute",top:-1,right:-1,width:8,height:8,borderTop:"1px solid rgba(157,140,207,0.3)",borderRight:"1px solid rgba(157,140,207,0.3)"}}),e.jsx("span",{style:{position:"absolute",bottom:-1,left:-1,width:8,height:8,borderBottom:"1px solid rgba(157,140,207,0.3)",borderLeft:"1px solid rgba(157,140,207,0.3)"}}),e.jsx("span",{style:{position:"absolute",bottom:-1,right:-1,width:8,height:8,borderBottom:"1px solid rgba(157,140,207,0.3)",borderRight:"1px solid rgba(157,140,207,0.3)"}}),e.jsxs("div",{children:["export ENVELO_API_KEY=",e.jsx("span",{style:{color:o.amber},children:"[your key from approval email]"})]}),e.jsx("div",{style:{marginTop:"4px"},children:"envelo start"})]}),e.jsxs("p",{style:{color:o.textDim,fontSize:"11px",marginTop:"8px"},children:["Your API key was sent to ",e.jsx("strong",{style:{color:o.text},children:t.contact_email})," on approval. Check your inbox."]})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("div",{style:{fontFamily:m,fontSize:"9px",letterSpacing:"2px",textTransform:"uppercase",color:o.purple,marginBottom:"8px"},children:"Step 3 — Integrate"}),e.jsxs("div",{style:{background:"rgba(0,0,0,.3)",border:"1px solid "+o.border,padding:"12px 16px",fontFamily:m,fontSize:"13px",color:o.text,position:"relative"},children:[e.jsx("span",{style:{position:"absolute",top:-1,left:-1,width:8,height:8,borderTop:"1px solid rgba(157,140,207,0.3)",borderLeft:"1px solid rgba(157,140,207,0.3)"}}),e.jsx("span",{style:{position:"absolute",top:-1,right:-1,width:8,height:8,borderTop:"1px solid rgba(157,140,207,0.3)",borderRight:"1px solid rgba(157,140,207,0.3)"}}),e.jsx("span",{style:{position:"absolute",bottom:-1,left:-1,width:8,height:8,borderBottom:"1px solid rgba(157,140,207,0.3)",borderLeft:"1px solid rgba(157,140,207,0.3)"}}),e.jsx("span",{style:{position:"absolute",bottom:-1,right:-1,width:8,height:8,borderBottom:"1px solid rgba(157,140,207,0.3)",borderRight:"1px solid rgba(157,140,207,0.3)"}}),e.jsx("div",{style:{color:o.textDim,fontSize:"11px",marginBottom:"8px"},children:"# Before any action, check boundaries"}),e.jsx("div",{style:{color:o.green},children:"curl -X POST http://localhost:9090/enforce \\"}),e.jsx("div",{style:{color:o.green,paddingLeft:"20px"},children:`  -d '{ "speed": 50, "lat": 30.5 }'`}),e.jsx("div",{style:{color:o.textDim,fontSize:"11px",marginTop:"12px",marginBottom:"8px"},children:"# Python integration"}),e.jsx("div",{style:{color:o.amber},children:"@agent.enforce"}),e.jsx("div",{style:{color:o.text},children:"def move(speed, position):"}),e.jsx("div",{style:{color:o.text,paddingLeft:"20px"},children:"robot.actuate(speed, position)"})]})]}),e.jsxs("div",{style:{padding:"12px 16px",border:"1px solid "+o.border,background:"rgba(157,140,207,0.03)"},children:[e.jsx("div",{style:{fontFamily:m,fontSize:"9px",letterSpacing:"2px",textTransform:"uppercase",color:o.purple,marginBottom:"8px"},children:"What happens automatically"}),e.jsxs("div",{style:{display:"grid",gap:"6px",fontSize:"12px",color:o.text},children:[e.jsx("div",{children:"✓ Interlock connects and downloads your boundaries"}),e.jsx("div",{children:"✓ CAT-72 test starts on first heartbeat (72-hour timer)"}),e.jsx("div",{children:"✓ Telemetry flows in real-time to this dashboard"}),e.jsx("div",{children:"✓ Certificate auto-issues when CAT-72 passes"})]})]})]}),P&&t.state==="pending"&&e.jsxs(w,{children:[e.jsx("div",{style:{fontFamily:"IBM Plex Mono, monospace",fontSize:"10px",letterSpacing:"1px",textTransform:"uppercase",color:"#d65c5c",marginBottom:"8px"},children:"Reject Application"}),e.jsx("textarea",{value:S,onChange:n=>A(n.target.value),rows:3,placeholder:"Reason for rejection...",style:{width:"100%",background:"rgba(255,255,255,0.03)",border:"1px solid rgba(255,255,255,0.06)",color:"rgba(255,255,255,.94)",fontSize:"13px",padding:"12px",fontFamily:"inherit",resize:"none",outline:"none"}}),e.jsxs("div",{style:{display:"flex",gap:"8px",marginTop:"8px",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>{O(!1),A("")},className:"px-3 py-2 btn",style:{fontSize:"11px"},children:"Cancel"}),e.jsx("button",{onClick:te,className:"px-3 py-2 btn",style:{fontSize:"11px",color:"#d65c5c",borderColor:"rgba(214,92,92,.3)"},children:"Reject"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(w,{children:[e.jsx("div",{className:"hud-label",style:{marginBottom:"16px"},children:"System Details"}),e.jsxs("p",{style:{color:o.text,marginBottom:"8px"},children:[e.jsx("strong",{children:"Version:"})," ",t.system_version||"N/A"]}),e.jsxs("p",{style:{color:o.text,marginBottom:"8px"},children:[e.jsx("strong",{children:"Manufacturer:"})," ",t.manufacturer||"N/A"]}),t.facility_location&&e.jsxs("p",{style:{color:o.text,marginBottom:"8px"},children:[e.jsx("strong",{children:"Facility:"})," ",t.facility_location]})]}),e.jsxs(w,{children:[e.jsx("div",{className:"hud-label",style:{marginBottom:"16px"},children:"Safety Boundaries"}),(()=>{const n=typeof t.envelope_definition=="string"?(()=>{try{return JSON.parse(t.envelope_definition)}catch{return null}})():t.envelope_definition,l=(n==null?void 0:n.boundaries)||[];return l.length===0?e.jsx("p",{style:{color:o.textDim,fontSize:"13px",fontStyle:"italic"},children:"No boundaries defined"}):e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsx("tr",{style:{borderBottom:"1px solid "+o.border},children:["Type","Constraint","Unit"].map(i=>e.jsx("th",{style:{fontFamily:m,fontSize:"9px",letterSpacing:"1.5px",textTransform:"uppercase",color:o.textDim,fontWeight:400,padding:"8px 12px",textAlign:"left"},children:i},i))})}),e.jsx("tbody",{children:l.map((i,h)=>{const E=i.max&&i.min?i.min+" - "+i.max:i.max?"<= "+i.max:i.min?">= "+i.min:i.radius_m?"radius "+i.radius_m+"m":i.corridors?i.corridors.join(", "):i.polygon||"-";return e.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,.04)"},children:[e.jsx("td",{style:{padding:"8px 12px",fontFamily:m,fontSize:"11px",color:o.purple,textTransform:"uppercase",letterSpacing:"0.5px"},children:i.type}),e.jsx("td",{style:{padding:"8px 12px",color:o.text,fontSize:"13px"},children:E}),e.jsx("td",{style:{padding:"8px 12px",fontFamily:m,fontSize:"11px",color:o.textDim},children:i.unit||"-"})]},h)})})]})})()]})]}),(c==null?void 0:c.role)==="admin"&&(()=>{var l;const n=typeof t.envelope_definition=="string"?(()=>{try{return JSON.parse(t.envelope_definition)}catch{return null}})():t.envelope_definition;return((l=n==null?void 0:n.boundaries)==null?void 0:l.length)>0?null:e.jsx(je,{applicationId:t.id,initialBoundaries:t.envelope_definition||{},onSave:async i=>{try{await v.patch("/api/applicants/"+t.id,{envelope_definition:i}),s.show("Boundaries saved","success"),d({...t,envelope_definition:i})}catch(h){s.show("Failed: "+h.message,"error")}}})})(),e.jsxs(w,{children:[e.jsx("div",{className:"hud-label",style:{marginBottom:"16px"},children:"ODD Specification"}),(()=>{const n=typeof t.odd_specification=="string"?(()=>{try{return JSON.parse(t.odd_specification)}catch{return null}})():t.odd_specification;return!n||Object.keys(n).length===0?e.jsx("p",{style:{color:o.textDim,fontSize:"13px",fontStyle:"italic"},children:"Not specified"}):e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0"},children:Object.entries(n).map(([l,i])=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 12px",borderBottom:"1px solid rgba(255,255,255,.04)"},children:[e.jsx("span",{style:{fontFamily:m,fontSize:"10px",color:o.textDim,textTransform:"uppercase",letterSpacing:"0.5px"},children:l.replace(/_/g," ")}),e.jsx("span",{style:{color:o.text,fontSize:"13px",textAlign:"right"},children:Array.isArray(i)?i.join(", "):typeof i=="boolean"?i?"Yes":"No":String(i)})]},l))})})()]}),b.length>0&&e.jsxs(w,{children:[e.jsx("div",{className:"hud-label",style:{marginBottom:"16px"},children:"State Change History"}),e.jsxs("div",{style:{position:"relative",paddingLeft:"28px"},children:[e.jsx("div",{style:{position:"absolute",left:"8px",top:"4px",bottom:"4px",width:"2px",background:o.border}}),b.map((n,l)=>{var U,V,q;const i=(U=n.details)==null?void 0:U.new_state,h=i==="conformant"||i==="approved"?o.green:i==="suspended"||i==="revoked"||i==="rejected"?o.red:i==="under_review"||i==="testing"||n.action==="submitted"?o.purple:o.amber,E=i?i.replace(/_/g," "):(n.action||"").replace(/_/g," "),G=(q=(V=n.details)==null?void 0:V.old_state)==null?void 0:q.replace(/_/g," "),J=n.timestamp?new Date(n.timestamp):null;return e.jsxs("div",{style:{position:"relative",paddingBottom:l<b.length-1?"20px":"0"},children:[e.jsx("div",{style:{position:"absolute",left:"-24px",top:"2px",width:"12px",height:"12px",borderRadius:"50%",background:h+"08",border:"2px solid "+h}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:"16px"},children:[e.jsxs("div",{children:[e.jsx("span",{style:{fontFamily:m,fontSize:"12px",fontWeight:500,color:h,textTransform:"uppercase",letterSpacing:"0.5px"},children:E}),G&&n.action!=="submitted"&&e.jsxs("span",{style:{fontFamily:m,fontSize:"10px",color:o.textDim,marginLeft:"8px"},children:["from ",G]}),e.jsx("div",{style:{marginTop:"4px"},children:e.jsx("span",{style:{fontSize:"12px",color:o.textDim},children:n.user_email})})]}),J&&e.jsxs("div",{style:{textAlign:"right",flexShrink:0},children:[e.jsx("div",{style:{fontFamily:m,fontSize:"11px",color:o.textDim},children:J.toLocaleDateString()}),e.jsx("div",{style:{fontFamily:m,fontSize:"10px",color:o.textDim},children:J.toLocaleTimeString()})]})]})]},l)})]})]}),e.jsxs(w,{children:[e.jsx("div",{className:"hud-label",style:{marginBottom:"16px"},children:"Comments & Notes"}),e.jsxs("div",{style:{marginBottom:_.length>0?"20px":"0"},children:[e.jsx("textarea",{value:k,onChange:n=>D(n.target.value),rows:3,placeholder:"Add a comment or note...",className:"w-full px-4 py-3 outline-none resize-none",style:{background:"rgba(255,255,255,0.03)",border:"1px solid "+o.border,color:"rgba(255,255,255,.94)",fontSize:"13px",fontFamily:"inherit"},onFocus:n=>n.target.style.borderColor=o.purple,onBlur:n=>n.target.style.borderColor=o.border}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"12px",marginTop:"8px"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:(c==null?void 0:c.role)==="admin"&&e.jsxs("button",{onClick:()=>I(!B),className:"btn",style:{padding:"4px 10px",color:B?o.green:o.textDim,borderColor:B?"rgba(92,214,133,0.2)":"rgba(255,255,255,0.06)"},children:["Internal ",B?"ON":"OFF"]})}),e.jsx("button",{onClick:oe,disabled:R||!k.trim(),className:"px-4 py-2 btn",children:R?"Posting...":"Post Comment"})]})]}),_.length>0&&e.jsx("div",{style:{borderTop:"1px solid "+o.border,paddingTop:"16px"},children:_.map(n=>{var l,i;return e.jsxs("div",{style:{padding:"12px 0",borderBottom:"1px solid rgba(255,255,255,0.04)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:"16px",marginBottom:"6px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("span",{style:{fontFamily:m,fontSize:"12px",color:n.user_role==="admin"?o.purple:o.text,fontWeight:500},children:n.user_email}),n.user_role==="admin"&&e.jsx("span",{style:{fontFamily:m,fontSize:"9px",padding:"2px 6px",color:o.purple,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Admin"}),n.is_internal&&e.jsx("span",{style:{fontFamily:m,fontSize:"9px",padding:"2px 6px",color:o.amber,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Internal"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("span",{style:{fontFamily:m,fontSize:"10px",color:o.textDim},children:n.created_at?new Date(n.created_at).toLocaleString():""}),((c==null?void 0:c.role)==="admin"||(c==null?void 0:c.email)===n.user_email)&&e.jsx("button",{onClick:()=>ne(n.id),style:{background:"none",border:"none",color:o.textDim,cursor:"pointer",fontSize:"12px",padding:"0",opacity:.5},children:"x"})]})]}),e.jsx("p",{style:{color:(l=n.content)!=null&&l.startsWith("REJECTED:")?o.red:(i=n.content)!=null&&i.startsWith("INFO REQUESTED:")?o.amber:o.text,fontSize:"13px",lineHeight:1.6,margin:0,whiteSpace:"pre-wrap"},children:n.content})]},n.id)})}),_.length===0&&!k&&e.jsx("p",{style:{color:o.textDim,fontSize:"13px",fontStyle:"italic",margin:0},children:"No comments yet"})]}),t.notes&&e.jsxs(w,{children:[e.jsx("div",{className:"hud-label",style:{marginBottom:"16px"},children:"Applicant Notes"}),e.jsx("p",{style:{color:o.text,lineHeight:1.7,whiteSpace:"pre-wrap"},children:t.notes})]})]}):e.jsx("div",{style:{color:o.textDim},children:"Loading..."})}export{ze as default};
