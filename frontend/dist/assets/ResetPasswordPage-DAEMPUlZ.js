import{l as k,b as S,d as f,j as s,m as C}from"./index-BlCiafsT.js";import{r as e,e as E,f as R}from"./icons-DCxkC3Ow.js";import"./vendor-DxYwK_Rn.js";function q(){const[g]=k(),n=S(),t=g.get("token"),[r,w]=e.useState(""),[c,N]=e.useState(""),[i,v]=e.useState(!1),[d,l]=e.useState(""),[h,u]=e.useState(!1),[m,b]=e.useState(!1),[x,o]=e.useState(null);e.useEffect(()=>{if(!t){o(!1);return}f.get(`/api/auth/verify-reset-token/${t}`).then(()=>o(!0)).catch(()=>o(!1))},[t]);const y=async a=>{var p,j;if(a.preventDefault(),l(""),r.length<8){l("Password must be at least 8 characters");return}if(r!==c){l("Passwords do not match");return}u(!0);try{await f.post("/api/auth/reset-password",{token:t,new_password:r}),b(!0)}catch(P){l(((j=(p=P.response)==null?void 0:p.data)==null?void 0:j.detail)||"Reset failed. The link may have expired.")}finally{u(!1)}};return s.jsx("div",{"data-page":"login",children:s.jsx("div",{id:"sa-login",children:s.jsxs("div",{className:"sa-wrap",children:[s.jsxs("div",{className:"sa-card",children:[s.jsx("div",{className:"sa-brand",children:s.jsx(C,{height:48})}),s.jsx("h1",{className:"sa-title",children:m?s.jsxs(s.Fragment,{children:["Password ",s.jsx("em",{children:"Reset"})]}):s.jsxs(s.Fragment,{children:["New ",s.jsx("em",{children:"Password"})]})}),x===null?s.jsx("p",{className:"sa-lead",children:"Verifying reset link…"}):x===!1?s.jsxs("div",{children:[s.jsx("p",{className:"sa-lead",children:"This reset link is invalid or has expired."}),s.jsxs("button",{className:"sa-ghost",onClick:()=>n("/login"),children:["←"," Back to sign in"]})]}):m?s.jsxs("div",{children:[s.jsx("p",{className:"sa-lead",children:"Your password has been reset successfully."}),s.jsxs("button",{className:"sa-submit",onClick:()=>n("/login"),children:["Sign In ","→"]})]}):s.jsxs("div",{children:[d&&s.jsx("p",{className:"sa-error",children:d}),s.jsxs("form",{onSubmit:y,children:[s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{className:"sa-field-label",children:"New Password"}),s.jsxs("div",{className:"sa-pw-wrap",children:[s.jsx("input",{className:"sa-input",type:i?"text":"password",placeholder:"•".repeat(12),value:r,onChange:a=>w(a.target.value),required:!0,autoFocus:!0}),s.jsx("button",{className:"sa-pw-toggle",type:"button",onClick:()=>v(!i),children:i?s.jsx(E,{size:16}):s.jsx(R,{size:16})})]})]}),s.jsxs("div",{className:"sa-field",children:[s.jsx("label",{className:"sa-field-label",children:"Confirm Password"}),s.jsx("input",{className:"sa-input",type:i?"text":"password",placeholder:"•".repeat(12),value:c,onChange:a=>N(a.target.value),required:!0})]}),s.jsx("button",{className:"sa-submit",type:"submit",disabled:h,children:h?"Resetting…":"Reset Password →"})]}),s.jsxs("button",{className:"sa-ghost",onClick:()=>n("/login"),children:["←"," Back to sign in"]})]})]}),s.jsx("hr",{className:"sa-sep"}),s.jsxs("div",{className:"sa-footer",children:[s.jsxs("a",{href:"https://sentinelauthority.org",target:"_blank",rel:"noreferrer noopener",className:"sa-footer-text",style:{textDecoration:"none"},children:["←"," Public Site"]}),s.jsxs("div",{style:{display:"flex",gap:"16px"},children:[s.jsx("a",{href:"https://sentinelauthority.org/privacy.html",children:"Privacy"}),s.jsx("a",{href:"https://sentinelauthority.org/terms.html",children:"Terms"})]})]})]})})})}export{q as default};
