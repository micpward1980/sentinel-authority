import{u as Y,a as G,b as Q,c as U,d as m,j as t,s as e,L as d,A as Z}from"./index-yBtxF6iz.js";import{r as c,F as $,A as I,c as H,W as q,h as J,P as ee,i as te,j as re,k as ne}from"./icons-CHtaS-ny.js";import{P as _}from"./Panel-DzaT4GMG.js";import{S as u}from"./StatCard-CQYrVg1q.js";import{E as ie}from"./EmptyState-DoXMh6tF.js";import"./vendor-Dzneq-kE.js";function ae(){Y();const{user:o}=G();Q();const S=U(),[j,z]=c.useState([]),[p,P]=c.useState(0),[R,O]=c.useState({}),[b,B]=c.useState([]),[x,D]=c.useState(!0),[f,N]=c.useState(null),[g,F]=c.useState([]);c.useEffect(()=>{Promise.all([m.get("/api/applications/").catch(()=>({data:[]})),m.get("/api/certificates/").catch(()=>({data:[]})),m.get("/api/envelo/monitoring/overview").catch(()=>({data:null})),m.get("/api/audit/my-logs?limit=5&offset=0").catch(()=>({data:{logs:[]}}))]).then(([n,l,r,i])=>{z(n.data.applications||n.data||[]),B(l.data||[]),r.data&&N(r.data),F(i.data.logs||i.data||[]),D(!1)})},[]);const T=[{key:"pending",label:"Submitted"},{key:"under_review",label:"In Review"},{key:"approved",label:"Approved"},{key:"testing",label:"Testing"},{key:"conformant",label:"Conformant"}],A=n=>T.findIndex(l=>l.key===n),k=n=>{switch(n){case"pending":return"Awaiting review";case"under_review":return"Under evaluation";case"approved":return"Preparing CAT-72";case"testing":return"Test in progress";case"conformant":return"Certificate issued";case"revoked":return"Suspended";default:return"Pending"}},y=n=>n==="conformant"?e.accentGreen:n==="revoked"||n==="suspended"?e.accentRed:n==="testing"||n==="approved"?e.purpleBright:e.accentAmber;return x?t.jsx("div",{style:{color:e.textTertiary,padding:"clamp(16px, 4vw, 40px)",textAlign:"center"},children:"Loading..."}):t.jsxs("div",{className:"space-y-6",style:{maxWidth:"1000px",margin:"0 auto"},children:[t.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:"16px"},children:t.jsxs("div",{children:[t.jsx("p",{style:{fontFamily:e.mono,fontSize:"10px",letterSpacing:"4px",textTransform:"uppercase",color:e.purpleBright,marginBottom:"8px"},children:"ODDC Certification"}),t.jsxs("h1",{style:{fontFamily:"Georgia, 'Source Serif 4', serif",fontSize:"clamp(24px, 5vw, 36px)",fontWeight:200,margin:0},children:["Welcome",o!=null&&o.full_name?`, ${o.full_name.split(" ")[0]}`:""]}),t.jsxs("p",{style:{color:e.textSecondary,marginTop:"8px"},children:[o!=null&&o.organization?o.organization+" · ":"","Track your certification progress and manage your systems."]})]})}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:[t.jsx(u,{onClick:()=>S("/applications"),label:"Applications",value:j.length,color:e.purpleBright,icon:t.jsx($,{fill:"currentColor",fillOpacity:.15,strokeWidth:1.8,className:"w-5 h-5",style:{color:e.purpleBright}}),subtitle:j.filter(n=>n.state==="pending"||n.state==="under_review").length>0?`${j.filter(n=>n.state==="pending"||n.state==="under_review").length} in review`:null}),t.jsx(u,{onClick:()=>S("/certificates"),label:"Certificates",value:b.length,color:e.accentGreen,icon:t.jsx(I,{fill:"currentColor",fillOpacity:.15,strokeWidth:1.8,className:"w-5 h-5",style:{color:e.accentGreen}}),subtitle:b.filter(n=>n.state==="conformant").length>0?`${b.filter(n=>n.state==="conformant").length} active`:null}),t.jsx(u,{onClick:()=>S("/cat72"),label:"Active Tests",value:j.filter(n=>n.state==="testing").length,color:e.accentAmber,icon:t.jsx(H,{fill:"currentColor",fillOpacity:.15,strokeWidth:1.8,className:"w-5 h-5",style:{color:e.accentAmber}})}),(()=>{var h;const l=((f==null?void 0:f.sessions)||[]).filter(a=>{const w=a.last_heartbeat_at||a.last_telemetry_at||a.last_activity||a.started_at;return a.status==="active"&&w&&Date.now()-new Date(w).getTime()<12e4}).length,r=((h=f==null?void 0:f.summary)==null?void 0:h.total)||0,i=r>0,s=i?l>0?e.accentGreen:e.accentAmber:e.textTertiary,v=i?l>0?`${l} of ${r} online`:"All systems offline":"No active systems";return t.jsx(u,{onClick:()=>S("/monitoring"),label:"Live Status",value:i?l:"—",color:s,icon:t.jsx(q,{fill:"currentColor",fillOpacity:.15,strokeWidth:1.8,className:"w-5 h-5",style:{color:s}}),subtitle:v})})()]}),t.jsxs(_,{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"12px",marginBottom:"16px"},children:[t.jsx("h2",{style:{fontFamily:e.mono,fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:e.textTertiary,margin:0},children:"Your Applications"}),j.length>0&&t.jsx(d,{to:"/applications",style:{fontFamily:e.mono,fontSize:"10px",color:e.purpleBright,textDecoration:"none",letterSpacing:"1px"},children:"View All →"})]}),j.length===0?t.jsxs("div",{style:{textAlign:"center",padding:"56px 20px"},children:[t.jsx("div",{style:{width:"72px",height:"72px",background:"transparent",border:"1px solid rgba(0,0,0,0.05)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 20px"},children:t.jsx(J,{fill:"currentColor",fillOpacity:.15,strokeWidth:1.8,size:32,style:{color:e.purpleBright,opacity:.7}})}),t.jsx("p",{style:{color:e.textPrimary,fontSize:"17px",fontWeight:500,marginBottom:"8px",fontFamily:"Georgia, 'Source Serif 4', serif"},children:"Begin Your Certification"}),t.jsx("p",{style:{color:e.textTertiary,fontSize:"13px",marginBottom:"28px",maxWidth:"360px",margin:"0 auto 28px",lineHeight:"1.6"},children:"Submit your autonomous system for ODDC certification. Our CAT-72 test validates real-time boundary enforcement over 72 hours."}),t.jsxs(d,{to:"/applications/new",className:"inline-flex items-center gap-2 px-6 py-3 no-underline",style:{background:e.purplePrimary,border:"none",color:"#fff",fontFamily:e.mono,fontSize:"11px",letterSpacing:"1px",textTransform:"uppercase"},children:[t.jsx(ee,{className:"w-4 h-4"}),"New Application"]})]}):t.jsx("div",{className:"space-y-4",children:j.map(n=>{var r;const l=A(n.state);return t.jsx(d,{to:`/applications/${n.id}`,style:{textDecoration:"none",display:"block"},children:t.jsxs("div",{style:{padding:"20px",background:"transparent",border:`1px solid ${e.borderGlass}`,cursor:"pointer",transition:"border-color 0.2s"},onMouseEnter:i=>i.currentTarget.style.borderColor=e.purpleBright,onMouseLeave:i=>i.currentTarget.style.borderColor=e.borderGlass,children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"12px",marginBottom:"16px"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{fontWeight:500,color:e.textPrimary,fontSize:"15px",marginBottom:"4px"},children:n.system_name}),t.jsxs("div",{style:{fontSize:"11px",color:e.textTertiary,fontFamily:e.mono},children:[n.application_number," · ",(r=n.system_type)==null?void 0:r.replace(/_/g," ")]})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx("span",{style:{fontSize:"12px",color:e.textTertiary},children:k(n.state)}),t.jsx("span",{style:{padding:"4px 12px",fontSize:"10px",fontFamily:e.mono,textTransform:"uppercase",letterSpacing:"1px",background:`${y(n.state)}06`,color:y(n.state),border:`1px solid ${y(n.state)}10`},children:n.state})]})]}),t.jsx("div",{style:{display:"flex",gap:"3px",height:"4px"},children:T.map((i,s)=>t.jsx("div",{style:{flex:1,background:s<=l?y(n.state):"rgba(0,0,0,0.025)"}},i.key))})]})},n.id)})})]}),b.length===0&&t.jsx(ie,{icon:I,title:"No Certificates Yet",description:"Certificates are issued after your system passes the 72-hour CAT-72 conformance test. Submit an application to begin."}),b.length>0&&t.jsxs(_,{children:[t.jsx("h2",{style:{fontFamily:e.mono,fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:e.textTertiary,marginBottom:"16px"},children:"Your Certificates"}),t.jsx("div",{className:"space-y-3",children:b.map(n=>t.jsxs("div",{style:{padding:"16px",background:"transparent",border:"1px solid rgba(0,0,0,0.05)",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"12px"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{fontWeight:500,color:e.accentGreen,marginBottom:"4px",fontFamily:e.mono,fontSize:"14px"},children:n.certificate_number}),t.jsxs("div",{style:{fontSize:"12px",color:e.textTertiary},children:["Issued: ",new Date(n.issued_at).toLocaleDateString(),n.expires_at?` · Expires: ${new Date(n.expires_at).toLocaleDateString()}`:""]})]}),t.jsx("div",{style:{display:"flex",gap:"8px"},children:t.jsx("a",{href:`${Z}/api/certificates/${n.certificate_number}/pdf`,target:"_blank",style:{padding:"8px 16px",background:e.purplePrimary,color:"#fff",fontSize:"11px",fontFamily:e.mono,textDecoration:"none"},children:"Download PDF"})})]},n.id))})]}),t.jsxs(_,{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"12px",marginBottom:"16px"},children:[t.jsx("h2",{style:{fontFamily:e.mono,fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:e.textTertiary,margin:0},children:"Recent Activity"}),t.jsx(d,{to:"/my-activity",style:{fontFamily:e.mono,fontSize:"10px",color:e.purpleBright,textDecoration:"none",letterSpacing:"1px"},children:"View All →"})]}),g.length===0?t.jsx("p",{style:{color:e.textTertiary,fontSize:"13px",textAlign:"center",padding:"20px 0"},children:"No activity yet"}):t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1px"},children:g.map((n,l)=>{var w,L,E,M,V;const r={user_login:"Signed in",user_registered:"Account created",login_failed:"Failed login attempt",application_submitted:"Application submitted",application_state_changed:"Application status updated",application_deleted:"Application deleted",test_created:"CAT-72 test scheduled",test_started:"CAT-72 test started",test_completed:"CAT-72 test completed",certificate_issued:"Certificate issued",certificate_suspended:"Certificate suspended",certificate_revoked:"Certificate revoked",certificate_reinstated:"Certificate reinstated",api_key_created:"API key created",api_key_revoked:"API key revoked",password_changed:"Password changed",profile_updated:"Profile updated","2fa_enabled":"Two-factor authentication enabled","2fa_disabled":"Two-factor authentication disabled"},i={user_login:e.textTertiary,login_failed:e.accentRed,application_submitted:e.purpleBright,application_state_changed:e.accentAmber,test_created:e.purpleBright,test_started:e.accentAmber,test_completed:e.accentGreen,certificate_issued:e.accentGreen,certificate_suspended:e.accentAmber,certificate_revoked:e.accentRed,api_key_created:e.purpleBright,api_key_revoked:e.accentRed},s=r[n.action]||n.action.replace(/_/g," "),v=i[n.action]||e.textSecondary,h=((w=n.details)==null?void 0:w.system_name)||((L=n.details)==null?void 0:L.application_number)||((E=n.details)==null?void 0:E.test_id)||((M=n.details)==null?void 0:M.certificate_number)||((V=n.details)==null?void 0:V.key_name)||"",a=K=>{const X=Date.now()-new Date(K).getTime(),C=Math.floor(X/6e4);if(C<1)return"just now";if(C<60)return C+"m ago";const W=Math.floor(C/60);return W<24?W+"h ago":Math.floor(W/24)+"d ago"};return t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"10px 0",borderBottom:l<g.length-1?"1px solid rgba(0,0,0,0.05)":"none"},children:[t.jsx("div",{style:{width:"6px",height:"6px",borderRadius:"50%",background:v,flexShrink:0}}),t.jsxs("div",{style:{flex:1,minWidth:0},children:[t.jsx("span",{style:{fontSize:"13px",color:e.textPrimary},children:s}),h&&t.jsx("span",{style:{fontSize:"12px",color:e.textTertiary,marginLeft:"8px"},children:h})]}),t.jsx("span",{style:{fontSize:"11px",color:e.textTertiary,fontFamily:e.mono,flexShrink:0},children:a(n.timestamp)})]},n.id||l)})})]})]})}function fe(){const{user:o}=G();return(o==null?void 0:o.role)==="admin"?t.jsx(se,{}):t.jsx(ae,{})}function se(){const{user:o}=G(),S=Q(),j=Y(),z=U(),[p,P]=c.useState(null),[R,O]=c.useState([]),[b,B]=c.useState([]),[x,D]=c.useState([]),[f,N]=c.useState([]),[g,F]=c.useState(null),[T,A]=c.useState(!1),k=r=>{r&&A(!0),m.get("/api/dashboard/stats").then(i=>P(i.data)).catch(console.error),m.get("/api/dashboard/recent-applications").then(i=>O(i.data)).catch(console.error),m.get("/api/dashboard/active-tests").then(i=>B(i.data)).catch(console.error),m.get("/api/applications/").then(i=>D(i.data.applications||i.data||[])).catch(console.error),m.get("/api/dashboard/recent-certificates").then(i=>N(i.data)).catch(console.error),m.get("/api/envelo/monitoring/overview").then(i=>F(i.data)).catch(console.error),r&&setTimeout(()=>A(!1),800)};c.useEffect(()=>{k();const r=setInterval(k,3e4);return()=>clearInterval(r)},[]);const y={pending:x.filter(r=>r.state==="pending").length,under_review:x.filter(r=>r.state==="under_review").length,approved:x.filter(r=>r.state==="approved").length,testing:x.filter(r=>r.state==="testing").length,conformant:x.filter(r=>r.state==="conformant").length,revoked:x.filter(r=>r.state==="revoked"||r.state==="suspended").length},n=x.filter(r=>r.state==="pending"||r.state==="under_review"),l=async(r,i,s)=>{var v,h;if(await j({title:"Confirm",message:s+"?"}))try{if(await m.patch(`/api/applications/${r}/state?new_state=${i}`),i==="approved")try{await m.post("/api/apikeys/admin/provision",null,{params:{application_id:r,send_email:!0}}),S.show("Approved — API key provisioned and emailed to applicant","success")}catch{S.show("Approved — applicant can generate key from their dashboard","success")}k()}catch(a){S.show("Failed: "+(((h=(v=a.response)==null?void 0:v.data)==null?void 0:h.detail)||a.message),"error")}};return t.jsxs("div",{className:"space-y-6",style:{maxWidth:"1200px",margin:"0 auto"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:"16px",marginBottom:"28px"},children:[t.jsxs("div",{children:[t.jsxs("p",{style:{fontFamily:e.mono,fontSize:"10px",letterSpacing:"4px",textTransform:"uppercase",color:e.purpleBright,marginBottom:"8px",display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx("span",{style:{width:"24px",height:"1px",background:e.purpleBright}}),"Administration"]}),t.jsxs("h1",{style:{fontFamily:"Georgia, 'Source Serif 4', serif",fontSize:"clamp(24px, 5vw, 36px)",fontWeight:200,margin:0},children:["Welcome",o!=null&&o.full_name?`, ${o.full_name.split(" ")[0]}`:""]}),t.jsx("p",{style:{color:e.textTertiary,marginTop:"6px",fontSize:"13px",fontFamily:e.mono},children:new Date().toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})})]}),t.jsx("div",{style:{display:"flex",gap:"10px"},children:t.jsxs("button",{onClick:()=>k(!0),style:{background:"transparent",border:`1px solid ${e.borderGlass}`,padding:"10px 16px",color:e.textSecondary,cursor:"pointer",fontFamily:e.mono,fontSize:"10px",letterSpacing:"1px",textTransform:"uppercase",display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx(te,{fill:"currentColor",fillOpacity:.15,strokeWidth:1.8,size:14,style:T?{animation:"spin 0.8s linear infinite"}:{}})," ",T?"Refreshing...":"Refresh"]})})]}),(()=>{var v,h;const r=((v=g==null?void 0:g.sessions)==null?void 0:v.filter(a=>{const w=a.last_heartbeat_at||a.last_telemetry_at||a.started_at;return a.status==="active"&&w&&Date.now()-new Date(w).getTime()<12e4}).length)||((h=g==null?void 0:g.summary)==null?void 0:h.active)||0,i=f.filter(a=>a.expires_at&&a.state==="conformant"&&new Date(a.expires_at)<new Date(Date.now()+30*24*60*60*1e3)).length,s=n.length+i;return t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:[t.jsx(u,{label:"Total Applications",value:(p==null?void 0:p.total_applications)||0,color:e.purpleBright,icon:t.jsx($,{fill:"currentColor",fillOpacity:.15,strokeWidth:1.8,className:"w-5 h-5",style:{color:e.purpleBright}})}),t.jsx(u,{onClick:()=>z("/cat72"),label:"Active Tests",value:(p==null?void 0:p.active_tests)||0,color:e.accentAmber,icon:t.jsx(H,{fill:"currentColor",fillOpacity:.15,strokeWidth:1.8,className:"w-5 h-5",style:{color:e.accentAmber}})}),t.jsx(u,{label:"Active Certificates",value:(p==null?void 0:p.certificates_active)||0,color:e.accentGreen,icon:t.jsx(J,{fill:"currentColor",fillOpacity:.15,strokeWidth:1.8,className:"w-5 h-5",style:{color:e.accentGreen}})}),t.jsx(u,{label:"Online Interlocks",value:r,color:r>0?e.accentGreen:e.textTertiary,icon:t.jsx(q,{fill:"currentColor",fillOpacity:.15,strokeWidth:1.8,className:"w-5 h-5",style:{color:r>0?e.accentGreen:e.textTertiary}})}),t.jsx(u,{label:"Certificates Issued",value:(p==null?void 0:p.certificates_issued)||0,color:e.purpleBright,icon:t.jsx(I,{fill:"currentColor",fillOpacity:.15,strokeWidth:1.8,className:"w-5 h-5",style:{color:e.purpleBright}})}),t.jsx(u,{label:"Needs Action",value:s,color:s>0?e.accentAmber:e.textTertiary,icon:t.jsx(re,{fill:"currentColor",fillOpacity:.15,strokeWidth:1.8,className:"w-5 h-5",style:{color:s>0?e.accentAmber:e.textTertiary}})})]})})(),t.jsxs(_,{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"12px",marginBottom:"16px"},children:[t.jsx("h2",{style:{fontFamily:e.mono,fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:e.textTertiary,margin:0},children:"Certification Pipeline"}),t.jsxs("span",{style:{fontFamily:e.mono,fontSize:"11px",color:e.textTertiary},children:[x.length," total"]})]}),t.jsxs("div",{style:{display:"flex",gap:"4px",height:"32px",overflow:"hidden"},children:[[{key:"pending",label:"Pending",color:e.accentAmber,count:y.pending},{key:"under_review",label:"Review",color:e.accentAmber,count:y.under_review},{key:"approved",label:"Approved",color:e.purpleBright,count:y.approved},{key:"testing",label:"Testing",color:e.purpleBright,count:y.testing},{key:"conformant",label:"Conformant",color:e.accentGreen,count:y.conformant},{key:"revoked",label:"Suspended",color:e.accentRed,count:y.revoked}].map(r=>{const i=x.length||1,s=Math.max(r.count/i*100,r.count>0?8:0);return r.count>0?t.jsx("div",{style:{width:`${s}%`,background:`${r.color}08`,display:"flex",alignItems:"center",justifyContent:"center",minWidth:"48px",position:"relative",borderLeft:`2px solid ${r.color}`},title:`${r.label}: ${r.count}`,children:t.jsxs("span",{style:{fontFamily:e.mono,fontSize:"10px",color:r.color,whiteSpace:"nowrap"},children:[r.count," ",r.label]})},r.key):null}),x.length===0&&t.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"transparent",padding:"clamp(20px, 4vw, 40px) clamp(12px, 3vw, 20px)",textAlign:"center"},children:[t.jsx("div",{style:{width:"48px",height:"48px",background:"transparent",border:"1px solid rgba(0,0,0,0.05)",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"16px"},children:t.jsx($,{fill:"currentColor",fillOpacity:.15,strokeWidth:1.8,size:22,style:{color:e.purpleBright,opacity:.6}})}),t.jsx("p",{style:{color:e.textSecondary,fontSize:"14px",fontWeight:500,margin:"0 0 6px 0"},children:"No applications yet"}),t.jsx("p",{style:{color:e.textTertiary,fontSize:"12px",margin:"0 0 16px 0",maxWidth:"260px"},children:"Submit your first ODDC certification application to get started."})]})]})]}),n.length>0&&t.jsxs(_,{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"12px",marginBottom:"16px"},children:[t.jsxs("h2",{style:{fontFamily:e.mono,fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:e.accentAmber,margin:0},children:["⚡ Review Queue (",n.length,")"]}),t.jsx(d,{to:"/applications",style:{fontFamily:e.mono,fontSize:"10px",color:e.purpleBright,textDecoration:"none"},children:"View All →"})]}),t.jsx("div",{className:"space-y-3",children:n.slice(0,5).map(r=>{var i;return t.jsxs("div",{style:{padding:"14px 16px",background:"transparent",border:`1px solid ${e.borderGlass}`,display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"12px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[t.jsx(d,{to:`/applications/${r.id}`,style:{color:e.purpleBright,textDecoration:"none",fontWeight:500,fontSize:"14px"},children:r.system_name}),t.jsx("span",{style:{color:e.textTertiary,fontSize:"12px"},children:r.organization_name}),t.jsx("span",{className:"px-2 py-1",style:{background:"transparent",color:e.accentAmber,fontFamily:e.mono,fontSize:"9px",letterSpacing:"1px",textTransform:"uppercase"},children:(i=r.state)==null?void 0:i.replace("_"," ")})]}),t.jsxs("div",{style:{display:"flex",gap:"8px"},children:[r.state==="pending"&&t.jsx("button",{onClick:()=>l(r.id,"under_review",`Begin review for ${r.system_name}`),className:"px-3 py-1",style:{background:"transparent",border:"1px solid rgba(0,0,0,0.05)",color:e.accentAmber,fontFamily:e.mono,fontSize:"9px",letterSpacing:"1px",textTransform:"uppercase",cursor:"pointer"},children:"Begin Review"}),t.jsx("button",{onClick:()=>l(r.id,"approved",`Approve ${r.system_name}`),className:"px-3 py-1",style:{background:"transparent",border:"1px solid rgba(0,0,0,0.05)",color:e.accentGreen,fontFamily:e.mono,fontSize:"9px",letterSpacing:"1px",textTransform:"uppercase",cursor:"pointer"},children:"Approve"}),t.jsx("button",{onClick:()=>l(r.id,"suspended",`Suspend ${r.system_name}`),className:"px-3 py-1",style:{background:"transparent",border:"1px solid rgba(0,0,0,0.05)",color:e.accentRed,fontFamily:e.mono,fontSize:"9px",letterSpacing:"1px",textTransform:"uppercase",cursor:"pointer"},children:"Suspend"}),t.jsx(d,{to:`/applications/${r.id}`,className:"px-3 py-1 no-underline",style:{background:"transparent",border:`1px solid ${e.borderGlass}`,color:e.purpleBright,fontFamily:e.mono,fontSize:"9px",letterSpacing:"1px",textTransform:"uppercase"},children:"View"})]})]},r.id)})})]}),b.length>0&&t.jsxs(_,{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"12px",marginBottom:"16px"},children:[t.jsx("h2",{style:{fontFamily:e.mono,fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:e.textTertiary,margin:0},children:"Active CAT-72 Tests"}),t.jsx(d,{to:"/cat72",style:{fontFamily:e.mono,fontSize:"10px",color:e.purpleBright,textDecoration:"none"},children:"Console →"})]}),t.jsx("div",{className:"space-y-3",children:b.map(r=>{const i=Math.round(r.elapsed_seconds/(r.duration_hours*3600)*100),s=Math.max(0,(r.duration_hours*3600-r.elapsed_seconds)/3600).toFixed(1);return t.jsxs("div",{className:"p-4",style:{background:"transparent",border:`1px solid ${e.borderGlass}`},children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsxs("span",{style:{fontFamily:e.mono,fontSize:"12px",color:e.purpleBright},children:[r.organization_name," — ",r.system_name]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsxs("span",{style:{fontFamily:e.mono,fontSize:"11px",color:e.textTertiary},children:[s,"h remaining"]}),t.jsxs("span",{style:{fontFamily:e.mono,fontSize:"11px",color:e.accentAmber},children:[i,"%"]})]})]}),t.jsx("div",{className:"w-full h-2 overflow-hidden",style:{background:"transparent"},children:t.jsx("div",{className:"h-full transition-all",style:{width:`${i}%`,background:i>=100?e.accentGreen:e.purpleBright}})})]},r.id)})})]}),(()=>{const r=f.filter(i=>i.expires_at&&i.state==="conformant"&&new Date(i.expires_at)<new Date(Date.now()+2592e6));return r.length===0?null:t.jsxs("div",{style:{background:"transparent",border:"1px solid rgba(0,0,0,0.05)",padding:"16px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px"},children:[t.jsx(ne,{fill:"currentColor",fillOpacity:.15,strokeWidth:1.8,size:16,style:{color:e.accentAmber}}),t.jsxs("span",{style:{fontFamily:e.mono,fontSize:"11px",letterSpacing:"1px",textTransform:"uppercase",color:e.accentAmber,fontWeight:500},children:[r.length," Certificate",r.length>1?"s":""," Expiring Within 30 Days"]})]}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:r.map(i=>{const s=Math.ceil((new Date(i.expires_at)-Date.now())/864e5);return t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"12px",background:"transparent",padding:"10px 14px"},children:[t.jsxs("div",{children:[t.jsx("span",{style:{color:e.textPrimary,fontWeight:500,fontSize:"13px"},children:i.system_name}),t.jsx("span",{style:{color:e.textTertiary,fontSize:"12px",marginLeft:"12px"},children:i.organization_name})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsxs("span",{style:{fontFamily:e.mono,fontSize:"11px",color:s<=7?e.accentRed:e.accentAmber,fontWeight:500},children:[s,"d remaining"]}),t.jsx(d,{to:`/verify?cert=${i.certificate_number}`,style:{fontFamily:e.mono,fontSize:"10px",color:e.purpleBright,textDecoration:"none"},children:i.certificate_number})]})]},i.id)})})]})})(),f.length>0&&t.jsxs(_,{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"12px",marginBottom:"16px"},children:[t.jsx("h2",{style:{fontFamily:e.mono,fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:e.textTertiary,margin:0},children:"Recent Certificates"}),t.jsx(d,{to:"/certificates",style:{fontFamily:e.mono,fontSize:"10px",color:e.purpleBright,textDecoration:"none"},children:"View All →"})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsx("tr",{style:{borderBottom:`1px solid ${e.borderGlass}`},children:["Certificate","System","Status","Issued","Expires"].map(r=>t.jsx("th",{className:"px-4 py-3 text-left",style:{fontFamily:e.mono,fontSize:"9px",letterSpacing:"1.5px",textTransform:"uppercase",color:e.textTertiary,fontWeight:400},children:r},r))})}),t.jsx("tbody",{children:f.slice(0,5).map(r=>t.jsxs("tr",{style:{borderBottom:`1px solid ${e.borderGlass}`},children:[t.jsx("td",{className:"px-4 py-3",children:t.jsx(d,{to:`/verify?cert=${r.certificate_number}`,style:{color:e.purpleBright,textDecoration:"none",fontFamily:e.mono,fontSize:"12px"},children:r.certificate_number})}),t.jsxs("td",{className:"px-4 py-3",children:[t.jsx("span",{style:{color:e.textPrimary,fontSize:"13px"},children:r.system_name}),t.jsx("span",{style:{color:e.textTertiary,fontSize:"11px",marginLeft:"8px"},children:r.organization_name})]}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("span",{style:{fontFamily:e.mono,fontSize:"10px",letterSpacing:"1px",textTransform:"uppercase",padding:"2px 8px",background:r.state==="conformant"?"rgba(22,135,62,0.06)":"rgba(180,52,52,0.06)",color:r.state==="conformant"?e.accentGreen:e.accentRed},children:r.state})}),t.jsx("td",{className:"px-4 py-3",style:{color:e.textTertiary,fontSize:"13px"},children:r.issued_at?new Date(r.issued_at).toLocaleDateString():"-"}),t.jsx("td",{className:"px-4 py-3",style:{fontFamily:e.mono,fontSize:"12px",color:r.expires_at&&new Date(r.expires_at)<new Date(Date.now()+30*24*60*60*1e3)?e.accentAmber:e.textTertiary},children:r.expires_at?new Date(r.expires_at).toLocaleDateString():"-"})]},r.id))})]})})]}),t.jsxs(_,{children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h2",{style:{fontFamily:e.mono,fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:e.textTertiary,margin:0},children:"Recent Applications"}),t.jsx(d,{to:"/applications",style:{fontFamily:e.mono,fontSize:"10px",color:e.purpleBright,textDecoration:"none"},children:"View All →"})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{style:{borderBottom:`1px solid ${e.borderGlass}`},children:[t.jsx("th",{className:"px-4 py-3 text-left",style:{fontFamily:e.mono,fontSize:"9px",letterSpacing:"1.5px",textTransform:"uppercase",color:e.textTertiary,fontWeight:400},children:"System"}),t.jsx("th",{className:"px-4 py-3 text-left",style:{fontFamily:e.mono,fontSize:"9px",letterSpacing:"1.5px",textTransform:"uppercase",color:e.textTertiary,fontWeight:400},children:"Organization"}),t.jsx("th",{className:"px-4 py-3 text-left",style:{fontFamily:e.mono,fontSize:"9px",letterSpacing:"1.5px",textTransform:"uppercase",color:e.textTertiary,fontWeight:400},children:"State"}),t.jsx("th",{className:"px-4 py-3 text-left",style:{fontFamily:e.mono,fontSize:"9px",letterSpacing:"1.5px",textTransform:"uppercase",color:e.textTertiary,fontWeight:400},children:"Submitted"})]})}),t.jsx("tbody",{children:R.map(r=>t.jsxs("tr",{className:"transition-colors cursor-pointer",style:{borderBottom:`1px solid ${e.borderGlass}`},onClick:()=>window.location.hash=`#/applications/${r.id}`,children:[t.jsx("td",{className:"px-4 py-3",children:t.jsx(d,{to:`/applications/${r.id}`,style:{color:e.purpleBright,textDecoration:"none"},children:r.system_name})}),t.jsx("td",{className:"px-4 py-3",style:{color:e.textSecondary},children:r.organization_name}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("span",{className:"px-2 py-1 text-xs",style:{background:r.state==="conformant"?"rgba(22,135,62,0.06)":r.state==="observe"?"rgba(74,61,117,0.04)":r.state==="revoked"?"rgba(180,52,52,0.06)":"rgba(158,110,18,0.06)",color:r.state==="conformant"?e.accentGreen:r.state==="observe"?e.purpleBright:r.state==="revoked"?e.accentRed:e.accentAmber,fontFamily:e.mono,fontSize:"10px",letterSpacing:"1px",textTransform:"uppercase"},children:r.state})}),t.jsx("td",{className:"px-4 py-3",style:{color:e.textTertiary,fontSize:"14px"},children:r.submitted_at?new Date(r.submitted_at).toLocaleDateString():"N/A"})]},r.id))})]})})]})]})}export{ae as CustomerDashboard,fe as RoleBasedDashboard,se as default};
