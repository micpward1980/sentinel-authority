import{u as w,j as r,s as t,d as T}from"./index-D1p2w85X.js";import{r as o}from"./icons-DCxkC3Ow.js";import{P as k}from"./Panel-eeewJf_V.js";import{S as z}from"./SectionHeader-CL49uc-s.js";import"./vendor-DxYwK_Rn.js";function _(){const{user:A}=w(),[x,u]=o.useState([]),[y,f]=o.useState(0),[g,m]=o.useState(!0),[s,d]=o.useState(0),[n,h]=o.useState("30"),p=30,b=()=>{if(n==="all")return"";const e=new Date;return e.setDate(e.getDate()-parseInt(n)),e.toISOString()},j=async()=>{m(!0);try{const e=new URLSearchParams;e.set("limit",p),e.set("offset",s*p);const l=b();l&&e.set("date_from",l);const a=await T.get(`/api/audit/my-logs?${e}`);u(a.data.logs||[]),f(a.data.total||0)}catch(e){console.error("Failed to load activity:",e)}m(!1)};o.useEffect(()=>{j()},[s,n]);const S=e=>e!=null&&e.includes("approved")||e!=null&&e.includes("issued")||e!=null&&e.includes("conformant")?{icon:"✓",color:t.accentGreen}:e!=null&&e.includes("failed")||e!=null&&e.includes("revoked")||e!=null&&e.includes("suspended")?{icon:"✗",color:t.accentRed}:e!=null&&e.includes("pending")||e!=null&&e.includes("under_review")?{icon:"●",color:t.accentAmber}:{icon:"●",color:t.purpleBright},i=Math.ceil(y/p);return r.jsxs("div",{className:"space-y-6",style:{},children:[r.jsx(z,{label:"Account",title:"My Activity"}),r.jsxs(k,{children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"8px",marginBottom:"16px"},children:[r.jsx("span",{style:{fontFamily:t.mono,fontSize:"11px",color:t.textTertiary,letterSpacing:"1px",textTransform:"uppercase"},children:"Activity Log"}),r.jsxs("div",{style:{display:"flex",gap:"6px",alignItems:"center"},children:[["7","30","90","all"].map(e=>r.jsx("button",{onClick:()=>{h(e),d(0)},style:{padding:"4px 10px",background:n===e?"rgba(29,26,59,0.08)":"transparent",border:`1px solid ${n===e?"rgba(29,26,59,0.30)":t.borderGlass}`,color:n===e?t.purpleBright:t.textTertiary,fontFamily:t.mono,fontSize:"10px",cursor:"pointer",letterSpacing:"0.5px",transition:"all 0.15s ease"},children:e==="all"?"All":e+"d"},e)),r.jsxs("span",{style:{fontFamily:t.mono,fontSize:"10px",color:t.textTertiary,marginLeft:"8px"},children:[y," entries"]})]})]}),g?r.jsx("div",{style:{padding:"clamp(16px, 4vw, 40px)",textAlign:"center",color:t.textTertiary},children:"Loading..."}):x.length===0?r.jsx("div",{style:{padding:"clamp(16px, 4vw, 40px)",textAlign:"center",color:t.textTertiary},children:"No activity yet"}):r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:x.map(e=>{var a;const l=S(e.action);return r.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px",padding:"12px",background:t.cardSurface,borderBottom:`1px solid ${t.borderSubtle}`},children:[r.jsx("div",{style:{width:"28px",height:"28px",borderRadius:"50%",background:`${l.color}15`,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,marginTop:"2px"},children:r.jsx("span",{style:{color:l.color,fontSize:"13px",fontWeight:"bold"},children:l.icon})}),r.jsxs("div",{style:{flex:1,minWidth:0},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"12px",marginBottom:"4px"},children:[r.jsx("span",{style:{fontFamily:t.mono,fontSize:"12px",color:l.color,letterSpacing:"0.5px"},children:(a=e.action)==null?void 0:a.replace(/_/g," ")}),r.jsx("span",{style:{fontFamily:t.mono,fontSize:"10px",color:t.textTertiary,whiteSpace:"nowrap"},children:e.timestamp?new Date(e.timestamp).toLocaleString():""})]}),r.jsxs("div",{style:{fontSize:"12px",color:t.textSecondary},children:[e.resource_type,e.resource_id?` #${e.resource_id}`:"",e.details&&Object.keys(e.details).length>0&&r.jsx("span",{style:{color:t.textTertiary,marginLeft:"8px"},children:Object.entries(e.details).filter(([c])=>c!=="old_state").slice(0,3).map(([c,v])=>`${c.replace(/_/g," ")}: ${v}`).join(" · ")})]})]})]},e.id)})}),i>1&&r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"8px",paddingTop:"16px",marginTop:"16px",borderTop:`1px solid ${t.borderSubtle}`},children:[r.jsx("button",{onClick:()=>d(Math.max(0,s-1)),disabled:s===0,style:{padding:"6px 12px",background:"rgba(0,0,0,0.04)",border:`1px solid ${t.borderGlass}`,color:s===0?t.textTertiary:t.textPrimary,cursor:s===0?"not-allowed":"pointer",fontFamily:t.mono,fontSize:"11px"},children:"\\u2190 Prev"}),r.jsxs("span",{style:{padding:"6px 12px",fontFamily:t.mono,fontSize:"11px",color:t.textSecondary},children:[s+1," / ",i]}),r.jsx("button",{onClick:()=>d(Math.min(i-1,s+1)),disabled:s>=i-1,style:{padding:"6px 12px",background:"rgba(0,0,0,0.04)",border:`1px solid ${t.borderGlass}`,color:s>=i-1?t.textTertiary:t.textPrimary,cursor:s>=i-1?"not-allowed":"pointer",fontFamily:t.mono,fontSize:"11px"},children:"Next \\u2192"})]})]})]})}export{_ as default};
