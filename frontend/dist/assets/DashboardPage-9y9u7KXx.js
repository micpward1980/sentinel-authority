import{u as V,a as R,b as Y,c as Q,d as f,j as t,s as e,L as d,A as K,B as Z}from"./index-BedPMBGb.js";import{r as c,F as U,A as I,b as X,W as H,S as ee,P as te,i as re,j as ne,k as ie}from"./icons-BDb2Zpiz.js";import{P as k}from"./Panel-BxJjkWUN.js";import{S as h}from"./StatCard-DaTHKwxY.js";import{E as ae}from"./EmptyState-CgO73NWB.js";import"./vendor-BY35fGmp.js";function oe(){V();const{user:o}=R();Y();const v=Q(),[b,w]=c.useState([]),[p,G]=c.useState(0),[N,P]=c.useState({}),[j,B]=c.useState([]),[x,D]=c.useState(!0),[m,F]=c.useState(null),[g,W]=c.useState([]);c.useEffect(()=>{Promise.all([f.get("/api/applications/").catch(()=>({data:[]})),f.get("/api/certificates/").catch(()=>({data:[]})),f.get("/api/envelo/monitoring/overview").catch(()=>({data:null})),f.get("/api/audit/my-logs?limit=5&offset=0").catch(()=>({data:{logs:[]}}))]).then(([n,s,r,i])=>{w(n.data.applications||n.data||[]),B(s.data||[]),r.data&&F(r.data),W(i.data.logs||i.data||[]),D(!1)})},[]);const A=[{key:"pending",label:"Submitted"},{key:"under_review",label:"In Review"},{key:"approved",label:"Approved"},{key:"testing",label:"Testing"},{key:"conformant",label:"Conformant"}],T=n=>A.findIndex(s=>s.key===n),C=n=>{switch(n){case"pending":return"Awaiting review";case"under_review":return"Under evaluation";case"approved":return"Preparing CAT-72";case"testing":return"Test in progress";case"conformant":return"Certificate issued";case"revoked":return"Suspended";default:return"Pending"}},y=n=>n==="conformant"?e.accentGreen:n==="revoked"||n==="suspended"?e.accentRed:n==="testing"||n==="approved"?e.purpleBright:e.accentAmber;return x?t.jsx("div",{style:{color:e.textTertiary,padding:"clamp(16px, 4vw, 40px)",textAlign:"center"},children:"Loading..."}):t.jsxs("div",{className:"space-y-6",style:{maxWidth:"1000px",margin:"0 auto"},children:[t.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:"16px"},children:t.jsxs("div",{children:[t.jsx("p",{style:{fontFamily:e.mono,fontSize:"10px",letterSpacing:"4px",textTransform:"uppercase",color:e.purpleBright,marginBottom:"8px"},children:"ODDC Certification"}),t.jsxs("h1",{style:{fontFamily:"Georgia, 'Source Serif 4', serif",fontSize:"clamp(24px, 5vw, 36px)",fontWeight:200,margin:0},children:["Welcome",o!=null&&o.full_name?`, ${o.full_name.split(" ")[0]}`:""]}),t.jsxs("p",{style:{color:e.textSecondary,marginTop:"8px"},children:[o!=null&&o.organization?o.organization+" · ":"","Track your certification progress and manage your systems."]})]})}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:[t.jsx(h,{onClick:()=>v("/applications"),label:"Applications",value:b.length,color:e.purpleBright,icon:t.jsx(U,{fill:"currentColor",fillOpacity:.15,strokeWidth:1.8,className:"w-5 h-5",style:{color:e.purpleBright}}),subtitle:b.filter(n=>n.state==="pending"||n.state==="under_review").length>0?`${b.filter(n=>n.state==="pending"||n.state==="under_review").length} in review`:null}),t.jsx(h,{onClick:()=>v("/certificates"),label:"Certificates",value:j.length,color:e.accentGreen,icon:t.jsx(I,{fill:"currentColor",fillOpacity:.15,strokeWidth:1.8,className:"w-5 h-5",style:{color:e.accentGreen}}),subtitle:j.filter(n=>n.state==="conformant").length>0?`${j.filter(n=>n.state==="conformant").length} active`:null}),t.jsx(h,{onClick:()=>v("/cat72"),label:"Active Tests",value:b.filter(n=>n.state==="testing").length,color:e.accentAmber,icon:t.jsx(X,{fill:"currentColor",fillOpacity:.15,strokeWidth:1.8,className:"w-5 h-5",style:{color:e.accentAmber}})}),(()=>{var u;const s=((m==null?void 0:m.sessions)||[]).filter(a=>{const _=a.last_heartbeat_at||a.last_telemetry_at||a.last_activity||a.started_at;return a.status==="active"&&_&&Date.now()-new Date(_).getTime()<12e4}).length,r=((u=m==null?void 0:m.summary)==null?void 0:u.total)||0,i=r>0,l=i?s>0?e.accentGreen:e.accentAmber:e.textTertiary,S=i?s>0?`${s} of ${r} online`:"All systems offline":"No active systems";return t.jsx(h,{onClick:()=>v("/monitoring"),label:"Live Status",value:i?s:"—",color:l,icon:t.jsx(H,{fill:"currentColor",fillOpacity:.15,strokeWidth:1.8,className:"w-5 h-5",style:{color:l}}),subtitle:S})})()]}),t.jsxs(k,{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"12px",marginBottom:"16px"},children:[t.jsx("h2",{style:{fontFamily:e.mono,fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:e.textTertiary,margin:0},children:"Your Applications"}),b.length>0&&t.jsx(d,{to:"/applications",style:{fontFamily:e.mono,fontSize:"10px",color:e.purpleBright,textDecoration:"none",letterSpacing:"1px"},children:"View All →"})]}),b.length===0?t.jsxs("div",{style:{textAlign:"center",padding:"56px 20px"},children:[t.jsx("div",{style:{width:"72px",height:"72px",background:e.cardSurface,border:"1px solid "+e.borderSubtle,display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 20px",borderRadius:8},children:t.jsx(ee,{fill:"currentColor",fillOpacity:.15,strokeWidth:1.8,size:32,style:{color:e.purpleBright,opacity:.7}})}),t.jsx("p",{style:{color:e.textPrimary,fontSize:"17px",fontWeight:500,marginBottom:"8px",fontFamily:"Georgia, 'Source Serif 4', serif"},children:"Begin Your Certification"}),t.jsx("p",{style:{color:e.textTertiary,fontSize:"13px",marginBottom:"28px",maxWidth:"360px",margin:"0 auto 28px",lineHeight:"1.6"},children:"Submit your autonomous system for ODDC certification. Our CAT-72 test validates real-time boundary enforcement over 72 hours."}),t.jsxs(d,{to:"/applications/new",className:"inline-flex items-center gap-2 px-6 py-3 no-underline",style:{background:"transparent",border:"none",color:e.purpleBright,fontFamily:e.mono,fontSize:"11px",letterSpacing:"1px",textTransform:"uppercase"},children:[t.jsx(te,{className:"w-4 h-4"}),"New Application"]})]}):t.jsx("div",{className:"space-y-4",children:b.map(n=>{var r;const s=T(n.state);return t.jsx(d,{to:`/applications/${n.id}`,style:{textDecoration:"none",display:"block"},children:t.jsxs("div",{style:{padding:"20px",background:e.cardSurface,border:`1px solid ${e.borderGlass}`,cursor:"pointer",transition:"border-color 0.2s"},onMouseEnter:i=>i.currentTarget.style.borderColor=e.purpleBright,onMouseLeave:i=>i.currentTarget.style.borderColor=e.borderGlass,children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"12px",marginBottom:"16px"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{fontWeight:500,color:e.textPrimary,fontSize:"15px",marginBottom:"4px"},children:n.system_name}),t.jsxs("div",{style:{fontSize:"11px",color:e.textTertiary,fontFamily:e.mono},children:[n.application_number," · ",(r=n.system_type)==null?void 0:r.replace(/_/g," ")]})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx("span",{style:{fontSize:"12px",color:e.textTertiary},children:C(n.state)}),t.jsx("span",{style:{padding:"4px 12px",fontSize:"10px",fontFamily:e.mono,textTransform:"uppercase",letterSpacing:"1px",background:`${y(n.state)}06`,color:y(n.state),border:`1px solid ${y(n.state)}10`},children:n.state})]})]}),t.jsx("div",{style:{display:"flex",gap:"3px",height:"4px"},children:A.map((i,l)=>t.jsx("div",{style:{flex:1,background:l<=s?y(n.state):"rgba(0,0,0,0.025)"}},i.key))})]})},n.id)})})]}),j.length===0&&t.jsx(ae,{icon:I,title:"No Certificates Yet",description:"Certificates are issued after your system passes the 72-hour CAT-72 conformance test. Submit an application to begin."}),j.length>0&&t.jsxs(k,{children:[t.jsx("h2",{style:{fontFamily:e.mono,fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:e.textTertiary,marginBottom:"16px"},children:"Your Certificates"}),t.jsx("div",{className:"space-y-3",children:j.map(n=>t.jsxs("div",{style:{padding:"16px",background:e.cardSurface,border:"1px solid "+e.borderSubtle,display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"12px",borderRadius:8},children:[t.jsxs("div",{children:[t.jsx("div",{style:{fontWeight:500,color:e.accentGreen,marginBottom:"4px",fontFamily:e.mono,fontSize:"14px"},children:n.certificate_number}),t.jsxs("div",{style:{fontSize:"12px",color:e.textTertiary},children:["Issued: ",new Date(n.issued_at).toLocaleDateString(),n.expires_at?` · Expires: ${new Date(n.expires_at).toLocaleDateString()}`:""]})]}),t.jsx("div",{style:{display:"flex",gap:"8px"},children:t.jsx("a",{href:`${K}/api/certificates/${n.certificate_number}/pdf`,target:"_blank",rel:"noreferrer noopener",style:{padding:"8px 16px",background:"transparent",color:e.purpleBright,fontSize:"11px",fontFamily:e.mono,textDecoration:"none"},children:"Download PDF"})})]},n.id))})]}),t.jsxs(k,{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"12px",marginBottom:"16px"},children:[t.jsx("h2",{style:{fontFamily:e.mono,fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:e.textTertiary,margin:0},children:"Recent Activity"}),t.jsx(d,{to:"/my-activity",style:{fontFamily:e.mono,fontSize:"10px",color:e.purpleBright,textDecoration:"none",letterSpacing:"1px"},children:"View All →"})]}),g.length===0?t.jsx("p",{style:{color:e.textTertiary,fontSize:"13px",textAlign:"center",padding:"20px 0"},children:"No activity yet"}):t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1px"},children:g.map((n,s)=>{var _,L,O,E,M;const r={user_login:"Signed in",user_registered:"Account created",login_failed:"Failed login attempt",application_submitted:"Application submitted",application_state_changed:"Application status updated",application_deleted:"Application deleted",test_created:"CAT-72 test scheduled",test_started:"CAT-72 test started",test_completed:"CAT-72 test completed",certificate_issued:"Certificate issued",certificate_suspended:"Certificate suspended",certificate_revoked:"Certificate revoked",certificate_reinstated:"Certificate reinstated",api_key_created:"API key created",api_key_revoked:"API key revoked",password_changed:"Password changed",profile_updated:"Profile updated","2fa_enabled":"Two-factor authentication enabled","2fa_disabled":"Two-factor authentication disabled"},i={user_login:e.textTertiary,login_failed:e.accentRed,application_submitted:e.purpleBright,application_state_changed:e.accentAmber,test_created:e.purpleBright,test_started:e.accentAmber,test_completed:e.accentGreen,certificate_issued:e.accentGreen,certificate_suspended:e.accentAmber,certificate_revoked:e.accentRed,api_key_created:e.purpleBright,api_key_revoked:e.accentRed},l=r[n.action]||n.action.replace(/_/g," "),S=i[n.action]||e.textSecondary,u=((_=n.details)==null?void 0:_.system_name)||((L=n.details)==null?void 0:L.application_number)||((O=n.details)==null?void 0:O.test_id)||((E=n.details)==null?void 0:E.certificate_number)||((M=n.details)==null?void 0:M.key_name)||"",a=q=>{const J=Date.now()-new Date(q).getTime(),z=Math.floor(J/6e4);if(z<1)return"just now";if(z<60)return z+"m ago";const $=Math.floor(z/60);return $<24?$+"h ago":Math.floor($/24)+"d ago"};return t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"10px 0",borderBottom:s<g.length-1?"1px solid "+e.borderSubtle:"none",borderRadius:8},children:[t.jsx("div",{style:{width:"6px",height:"6px",borderRadius:"50%",background:S,flexShrink:0}}),t.jsxs("div",{style:{flex:1,minWidth:0},children:[t.jsx("span",{style:{fontSize:"13px",color:e.textPrimary},children:l}),u&&t.jsx("span",{style:{fontSize:"12px",color:e.textTertiary,marginLeft:"8px"},children:u})]}),t.jsx("span",{style:{fontSize:"11px",color:e.textTertiary,fontFamily:e.mono,flexShrink:0},children:a(n.timestamp)})]},n.id||s)})})]})]})}function me(){const{user:o}=R();return(o==null?void 0:o.role)==="admin"?t.jsx(se,{}):t.jsx(oe,{})}function se(){const{user:o}=R(),v=Y(),b=V(),w=Q(),[p,G]=c.useState(null),[N,P]=c.useState([]),[j,B]=c.useState([]),[x,D]=c.useState([]),[m,F]=c.useState([]),[g,W]=c.useState(null),[A,T]=c.useState(!1),C=r=>{r&&T(!0),f.get("/api/dashboard/stats").then(i=>G(i.data)).catch(console.error),f.get("/api/dashboard/recent-applications").then(i=>P(i.data)).catch(console.error),f.get("/api/dashboard/active-tests").then(i=>B(i.data)).catch(console.error),f.get("/api/applications/").then(i=>D(i.data.applications||i.data||[])).catch(console.error),f.get("/api/dashboard/recent-certificates").then(i=>F(i.data)).catch(console.error),f.get("/api/envelo/monitoring/overview").then(i=>W(i.data)).catch(console.error),r&&setTimeout(()=>T(!1),800)};c.useEffect(()=>{C();const r=setInterval(C,3e4);return()=>clearInterval(r)},[]);const y={pending:x.filter(r=>r.state==="pending").length,under_review:x.filter(r=>r.state==="under_review").length,approved:x.filter(r=>r.state==="approved").length,testing:x.filter(r=>r.state==="testing").length,conformant:x.filter(r=>r.state==="conformant").length,revoked:x.filter(r=>r.state==="revoked"||r.state==="suspended").length},n=x.filter(r=>r.state==="pending"||r.state==="under_review"),s=async(r,i,l)=>{var S,u;if(await b({title:"Confirm",message:l+"?"}))try{if(await f.patch(`/api/applications/${r}/state?new_state=${i}`),i==="approved")try{await f.post("/api/apikeys/admin/provision",null,{params:{application_id:r,send_email:!0}}),v.show("Approved — API key provisioned and emailed to applicant","success")}catch{v.show("Approved — applicant can generate key from their dashboard","success")}C()}catch(a){v.show("Failed: "+(((u=(S=a.response)==null?void 0:S.data)==null?void 0:u.detail)||a.message),"error")}};return t.jsxs("div",{className:"space-y-6",style:{maxWidth:"1200px",margin:"0 auto"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:"16px",marginBottom:"28px"},children:[t.jsxs("div",{children:[t.jsxs("p",{style:{fontFamily:e.mono,fontSize:"10px",letterSpacing:"4px",textTransform:"uppercase",color:e.purpleBright,marginBottom:"8px",display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx("span",{style:{width:"24px",height:"1px",background:e.purpleBright}}),"Administration"]}),t.jsxs("h1",{style:{fontFamily:"Georgia, 'Source Serif 4', serif",fontSize:"clamp(24px, 5vw, 36px)",fontWeight:200,margin:0},children:["Welcome",o!=null&&o.full_name?`, ${o.full_name.split(" ")[0]}`:""]}),t.jsx("p",{style:{color:e.textTertiary,marginTop:"6px",fontSize:"13px",fontFamily:e.mono},children:new Date().toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})})]}),t.jsxs("button",{onClick:()=>C(!0),style:{background:e.cardSurface,border:`1px solid ${e.borderGlass}`,padding:"10px 16px",color:e.textSecondary,cursor:"pointer",fontFamily:e.mono,fontSize:"10px",letterSpacing:"1px",textTransform:"uppercase",display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx(re,{fill:"currentColor",fillOpacity:.15,strokeWidth:1.8,size:14,style:A?{animation:"spin 0.8s linear infinite"}:{}}),A?"Refreshing...":"Refresh"]})]}),(()=>{var S,u;const r=((S=g==null?void 0:g.sessions)==null?void 0:S.filter(a=>{const _=a.last_heartbeat_at||a.last_telemetry_at||a.started_at;return a.status==="active"&&_&&Date.now()-new Date(_).getTime()<12e4}).length)||((u=g==null?void 0:g.summary)==null?void 0:u.active)||0,i=m.filter(a=>a.expires_at&&a.state==="conformant"&&new Date(a.expires_at)<new Date(Date.now()+30*24*60*60*1e3)).length,l=n.length+i;return t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:[t.jsx(h,{onClick:()=>w("/applications"),label:"Total Applications",value:(p==null?void 0:p.total_applications)||0,color:e.purpleBright,icon:t.jsx(U,{fill:"currentColor",fillOpacity:.15,strokeWidth:1.8,className:"w-5 h-5",style:{color:e.purpleBright}})}),t.jsx(h,{onClick:()=>w("/cat72"),label:"Active Tests",value:(p==null?void 0:p.active_tests)||0,color:e.accentAmber,icon:t.jsx(X,{fill:"currentColor",fillOpacity:.15,strokeWidth:1.8,className:"w-5 h-5",style:{color:e.accentAmber}})}),t.jsx(h,{onClick:()=>w("/certificates"),label:"Active Certificates",value:(p==null?void 0:p.certificates_active)||0,color:e.accentGreen,icon:t.jsx(Z,{size:20})}),t.jsx(h,{onClick:()=>w("/monitoring"),label:"Online Interlocks",value:r,color:r>0?e.accentGreen:e.textTertiary,icon:t.jsx(H,{fill:"currentColor",fillOpacity:.15,strokeWidth:1.8,className:"w-5 h-5",style:{color:r>0?e.accentGreen:e.textTertiary}})}),t.jsx(h,{onClick:()=>w("/certificates"),label:"Certificates Issued",value:(p==null?void 0:p.certificates_issued)||0,color:e.purpleBright,icon:t.jsx(I,{fill:"currentColor",fillOpacity:.15,strokeWidth:1.8,className:"w-5 h-5",style:{color:e.purpleBright}})}),t.jsx(h,{onClick:()=>w("/applications"),label:"Needs Action",value:l,color:l>0?e.accentAmber:e.textTertiary,icon:t.jsx(ne,{fill:"currentColor",fillOpacity:.15,strokeWidth:1.8,className:"w-5 h-5",style:{color:l>0?e.accentAmber:e.textTertiary}})})]})})(),t.jsxs(k,{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"12px",marginBottom:"16px"},children:[t.jsx("h2",{style:{fontFamily:e.mono,fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:e.textTertiary,margin:0},children:"Certification Pipeline"}),t.jsxs("span",{style:{fontFamily:e.mono,fontSize:"11px",color:e.textTertiary},children:[x.length," total"]})]}),t.jsxs("div",{style:{display:"flex",gap:"4px",height:"32px",overflow:"hidden"},children:[[{key:"pending",label:"Pending",color:e.accentAmber,count:y.pending},{key:"under_review",label:"Review",color:e.accentAmber,count:y.under_review},{key:"approved",label:"Approved",color:e.purpleBright,count:y.approved},{key:"testing",label:"Testing",color:e.purpleBright,count:y.testing},{key:"conformant",label:"Conformant",color:e.accentGreen,count:y.conformant},{key:"revoked",label:"Suspended",color:e.accentRed,count:y.revoked}].map(r=>{const i=Math.max(r.count/(x.length||1)*100,r.count>0?8:0);return r.count>0?t.jsx("div",{style:{width:`${i}%`,background:`${r.color}08`,display:"flex",alignItems:"center",justifyContent:"center",minWidth:"48px",borderLeft:`2px solid ${r.color}`},title:`${r.label}: ${r.count}`,children:t.jsxs("span",{style:{fontFamily:e.mono,fontSize:"10px",color:r.color,whiteSpace:"nowrap"},children:[r.count," ",r.label]})},r.key):null}),x.length===0&&t.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"20px",textAlign:"center"},children:t.jsx("p",{style:{color:e.textSecondary,fontSize:"14px",margin:"0 0 6px 0"},children:"No applications yet"})})]})]}),n.length>0&&t.jsxs(k,{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"12px",marginBottom:"16px"},children:[t.jsxs("h2",{style:{fontFamily:e.mono,fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:e.accentAmber,margin:0},children:["⚡ Review Queue (",n.length,")"]}),t.jsx(d,{to:"/applications",style:{fontFamily:e.mono,fontSize:"10px",color:e.purpleBright,textDecoration:"none"},children:"View All →"})]}),t.jsx("div",{className:"space-y-3",children:n.slice(0,5).map(r=>{var i;return t.jsxs("div",{style:{padding:"14px 16px",background:e.cardSurface,border:`1px solid ${e.borderGlass}`,display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"12px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[t.jsx(d,{to:`/applications/${r.id}`,style:{color:e.purpleBright,textDecoration:"none",fontWeight:500,fontSize:"14px"},children:r.system_name}),t.jsx("span",{style:{color:e.textTertiary,fontSize:"12px"},children:r.organization_name}),t.jsx("span",{style:{color:e.accentAmber,fontFamily:e.mono,fontSize:"10px",letterSpacing:"1px",textTransform:"uppercase"},children:(i=r.state)==null?void 0:i.replace("_"," ")})]}),t.jsxs("div",{style:{display:"flex",gap:"8px"},children:[r.state==="pending"&&t.jsx("button",{onClick:()=>s(r.id,"under_review",`Begin review for ${r.system_name}`),style:{background:e.cardSurface,border:"1px solid "+e.borderSubtle,color:e.accentAmber,fontFamily:e.mono,fontSize:"10px",letterSpacing:"1px",textTransform:"uppercase",cursor:"pointer",padding:"4px 10px",borderRadius:8},children:"Begin Review"}),t.jsx("button",{onClick:()=>s(r.id,"approved",`Approve ${r.system_name}`),style:{background:e.cardSurface,border:"1px solid "+e.borderSubtle,color:e.accentGreen,fontFamily:e.mono,fontSize:"10px",letterSpacing:"1px",textTransform:"uppercase",cursor:"pointer",padding:"4px 10px",borderRadius:8},children:"Approve"}),t.jsx("button",{onClick:()=>s(r.id,"suspended",`Suspend ${r.system_name}`),style:{background:e.cardSurface,border:"1px solid "+e.borderSubtle,color:e.accentRed,fontFamily:e.mono,fontSize:"10px",letterSpacing:"1px",textTransform:"uppercase",cursor:"pointer",padding:"4px 10px",borderRadius:8},children:"Suspend"}),t.jsx(d,{to:`/applications/${r.id}`,style:{background:e.cardSurface,border:`1px solid ${e.borderGlass}`,color:e.purpleBright,fontFamily:e.mono,fontSize:"10px",letterSpacing:"1px",textTransform:"uppercase",textDecoration:"none",padding:"4px 10px"},children:"View"})]})]},r.id)})})]}),j.length>0&&t.jsxs(k,{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"12px",marginBottom:"16px"},children:[t.jsx("h2",{style:{fontFamily:e.mono,fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:e.textTertiary,margin:0},children:"Active CAT-72 Tests"}),t.jsx(d,{to:"/cat72",style:{fontFamily:e.mono,fontSize:"10px",color:e.purpleBright,textDecoration:"none"},children:"Console →"})]}),t.jsx("div",{className:"space-y-3",children:j.map(r=>{const i=Math.round(r.elapsed_seconds/(r.duration_hours*3600)*100),l=Math.max(0,(r.duration_hours*3600-r.elapsed_seconds)/3600).toFixed(1);return t.jsxs("div",{style:{padding:"16px",background:e.cardSurface,border:`1px solid ${e.borderGlass}`},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[t.jsxs("span",{style:{fontFamily:e.mono,fontSize:"12px",color:e.purpleBright},children:[r.organization_name," — ",r.system_name]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsxs("span",{style:{fontFamily:e.mono,fontSize:"11px",color:e.textTertiary},children:[l,"h remaining"]}),t.jsxs("span",{style:{fontFamily:e.mono,fontSize:"11px",color:e.accentAmber},children:[i,"%"]})]})]}),t.jsx("div",{style:{height:"4px",background:"rgba(0,0,0,0.05)"},children:t.jsx("div",{style:{width:`${i}%`,height:"100%",background:i>=100?e.accentGreen:e.purpleBright,transition:"width 0.3s"}})})]},r.id)})})]}),(()=>{const r=m.filter(i=>i.expires_at&&i.state==="conformant"&&new Date(i.expires_at)<new Date(Date.now()+2592e6));return r.length===0?null:t.jsxs("div",{style:{background:e.cardSurface,border:"1px solid "+e.borderSubtle,padding:"16px",borderRadius:8},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px"},children:[t.jsx(ie,{fill:"currentColor",fillOpacity:.15,strokeWidth:1.8,size:16,style:{color:e.accentAmber}}),t.jsxs("span",{style:{fontFamily:e.mono,fontSize:"11px",letterSpacing:"1px",textTransform:"uppercase",color:e.accentAmber},children:[r.length," Certificate",r.length>1?"s":""," Expiring Within 30 Days"]})]}),r.map(i=>{const l=Math.ceil((new Date(i.expires_at)-Date.now())/864e5);return t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"12px",padding:"10px 0",borderTop:"1px solid "+e.borderSubtle,borderRadius:8},children:[t.jsxs("div",{children:[t.jsx("span",{style:{color:e.textPrimary,fontWeight:500,fontSize:"13px"},children:i.system_name}),t.jsx("span",{style:{color:e.textTertiary,fontSize:"12px",marginLeft:"12px"},children:i.organization_name})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsxs("span",{style:{fontFamily:e.mono,fontSize:"11px",color:l<=7?e.accentRed:e.accentAmber},children:[l,"d remaining"]}),t.jsx(d,{to:`/verify?cert=${i.certificate_number}`,style:{fontFamily:e.mono,fontSize:"10px",color:e.purpleBright,textDecoration:"none"},children:i.certificate_number})]})]},i.id)})]})})(),m.length>0&&t.jsxs(k,{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"12px",marginBottom:"16px"},children:[t.jsx("h2",{style:{fontFamily:e.mono,fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:e.textTertiary,margin:0},children:"Recent Certificates"}),t.jsx(d,{to:"/certificates",style:{fontFamily:e.mono,fontSize:"10px",color:e.purpleBright,textDecoration:"none"},children:"View All →"})]}),t.jsx("div",{style:{overflowX:"auto"},children:t.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[t.jsx("thead",{children:t.jsx("tr",{style:{borderBottom:`1px solid ${e.borderGlass}`},children:["Certificate","System","Status","Issued","Expires"].map(r=>t.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontFamily:e.mono,fontSize:"11px",letterSpacing:"0.08em",textTransform:"uppercase",color:e.textTertiary,fontWeight:400},children:r},r))})}),t.jsx("tbody",{children:m.slice(0,5).map(r=>t.jsxs("tr",{style:{borderBottom:`1px solid ${e.borderGlass}`},children:[t.jsx("td",{style:{padding:"12px 16px"},children:t.jsx(d,{to:`/verify?cert=${r.certificate_number}`,style:{color:e.purpleBright,textDecoration:"none",fontFamily:e.mono,fontSize:"12px"},children:r.certificate_number})}),t.jsxs("td",{style:{padding:"12px 16px"},children:[t.jsx("span",{style:{color:e.textPrimary,fontSize:"13px"},children:r.system_name}),t.jsx("span",{style:{color:e.textTertiary,fontSize:"11px",marginLeft:"8px"},children:r.organization_name})]}),t.jsx("td",{style:{padding:"12px 16px"},children:t.jsx("span",{style:{fontFamily:e.mono,fontSize:"10px",letterSpacing:"1px",textTransform:"uppercase",padding:"2px 8px",background:r.state==="conformant"?"rgba(22,135,62,0.06)":"rgba(180,52,52,0.06)",color:r.state==="conformant"?e.accentGreen:e.accentRed},children:r.state})}),t.jsx("td",{style:{padding:"12px 16px",color:e.textTertiary,fontSize:"13px"},children:r.issued_at?new Date(r.issued_at).toLocaleDateString():"-"}),t.jsx("td",{style:{padding:"12px 16px",fontFamily:e.mono,fontSize:"12px",color:r.expires_at&&new Date(r.expires_at)<new Date(Date.now()+30*24*60*60*1e3)?e.accentAmber:e.textTertiary},children:r.expires_at?new Date(r.expires_at).toLocaleDateString():"-"})]},r.id))})]})})]}),t.jsxs(k,{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[t.jsx("h2",{style:{fontFamily:e.mono,fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:e.textTertiary,margin:0},children:"Recent Applications"}),t.jsx(d,{to:"/applications",style:{fontFamily:e.mono,fontSize:"10px",color:e.purpleBright,textDecoration:"none"},children:"View All →"})]}),t.jsx("div",{style:{overflowX:"auto"},children:t.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[t.jsx("thead",{children:t.jsx("tr",{style:{borderBottom:`1px solid ${e.borderGlass}`},children:["System","Organization","State","Submitted"].map(r=>t.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontFamily:e.mono,fontSize:"11px",letterSpacing:"0.08em",textTransform:"uppercase",color:e.textTertiary,fontWeight:400},children:r},r))})}),t.jsx("tbody",{children:N.map(r=>t.jsxs("tr",{style:{borderBottom:`1px solid ${e.borderGlass}`,cursor:"pointer"},onClick:()=>window.location.hash=`#/applications/${r.id}`,children:[t.jsx("td",{style:{padding:"12px 16px"},children:t.jsx(d,{to:`/applications/${r.id}`,style:{color:e.purpleBright,textDecoration:"none"},children:r.system_name})}),t.jsx("td",{style:{padding:"12px 16px",color:e.textSecondary},children:r.organization_name}),t.jsx("td",{style:{padding:"12px 16px"},children:t.jsx("span",{style:{background:r.state==="conformant"?"rgba(22,135,62,0.06)":r.state==="revoked"?"rgba(180,52,52,0.06)":"rgba(158,110,18,0.06)",color:r.state==="conformant"?e.accentGreen:r.state==="revoked"?e.accentRed:e.accentAmber,fontFamily:e.mono,fontSize:"10px",letterSpacing:"1px",textTransform:"uppercase",padding:"2px 8px"},children:r.state})}),t.jsx("td",{style:{padding:"12px 16px",color:e.textTertiary,fontSize:"13px"},children:r.submitted_at?new Date(r.submitted_at).toLocaleDateString():"N/A"})]},r.id))})]})})]})]})}export{oe as CustomerDashboard,me as RoleBasedDashboard,se as default};
