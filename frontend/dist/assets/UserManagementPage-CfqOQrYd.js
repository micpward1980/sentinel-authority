import{u as O,b as q,d,j as e,s as a}from"./index-yBtxF6iz.js";import{r as p,P as H,n as J,U as X,i as K,m as Q,X as U}from"./icons-CHtaS-ny.js";import{P as B}from"./Panel-DzaT4GMG.js";import{S as V}from"./SectionHeader-CiDCzYXr.js";import{S as f}from"./StatCard-CQYrVg1q.js";import"./vendor-Dzneq-kE.js";function re(){var A,T;const h=O(),c=q(),[x,w]=p.useState([]),[R,_]=p.useState(!0),[b,z]=p.useState(""),[G,j]=p.useState(!1),[F,m]=p.useState(!1),[o,N]=p.useState(null),[i,u]=p.useState({email:"",full_name:"",company:"",role:"applicant"}),[v,k]=p.useState(!1);p.useEffect(()=>{y()},[]);const y=async()=>{try{const t=await d.get("/api/users/");w(t.data||[])}catch(t){console.log("Users API not available:",t),w([])}_(!1)},C=x.filter(t=>{var s,r,l;return((s=t.email)==null?void 0:s.toLowerCase().includes(b.toLowerCase()))||((r=t.full_name)==null?void 0:r.toLowerCase().includes(b.toLowerCase()))||((l=t.company)==null?void 0:l.toLowerCase().includes(b.toLowerCase()))}),g={total:x.length,admins:x.filter(t=>t.role==="admin").length,applicants:x.filter(t=>t.role==="applicant").length,pending:x.filter(t=>t.role==="pending").length,inactive:x.filter(t=>t.is_active===!1).length},L=async()=>{var t,s;if(!i.email||!i.full_name){c.show("Email and full name are required","warning");return}k(!0);try{const r=Math.random().toString(36).slice(-8)+"A1!";await d.post("/api/users/",{...i,password:r}),c.show("User created — share credentials securely","success"),j(!1),u({email:"",full_name:"",company:"",role:"applicant"}),y()}catch(r){c.show("Failed to create user: "+(((s=(t=r.response)==null?void 0:t.data)==null?void 0:s.detail)||r.message),"error")}k(!1)},S=async(t,s)=>{var r,l;if(await h({title:"Change Role",message:"Change user role to "+s.toUpperCase()+"?"}))try{await d.patch("/api/users/"+t,{role:s}),y(),m(!1)}catch(n){c.show("Failed to update role: "+(((l=(r=n.response)==null?void 0:r.data)==null?void 0:l.detail)||n.message),"error")}},E=async(t,s)=>{var l,n;const r=s?"deactivate":"activate";if(await h({title:r.charAt(0).toUpperCase()+r.slice(1),message:r.charAt(0).toUpperCase()+r.slice(1)+" this user?"}))try{await d.patch("/api/users/"+t,{is_active:!s}),y(),m(!1)}catch(P){c.show("Failed to update user: "+(((n=(l=P.response)==null?void 0:l.data)==null?void 0:n.detail)||P.message),"error")}},I=async(t,s)=>{var r,l;if(await h({title:"Reset Password",message:"Reset password for "+s+"?"}))try{const n=Math.random().toString(36).slice(-8)+"A1!";await d.post("/api/users/"+t+"/reset-password"),c.show("Password reset — share credentials securely","success")}catch(n){c.show("Failed to reset password: "+(((l=(r=n.response)==null?void 0:r.data)==null?void 0:l.detail)||n.message),"error")}},M=async(t,s)=>{var r,l;if(await h({title:"Approve User",message:"Approve "+s+" as an applicant?"}))try{await d.post("/api/users/"+t+"/approve"),y(),m(!1)}catch(n){c.show("Failed to approve: "+(((l=(r=n.response)==null?void 0:r.data)==null?void 0:l.detail)||n.message),"error")}},W=async(t,s)=>{var r,l;if(await h({title:"Reject User",message:"Reject "+s+"? Their account will be deactivated.",danger:!0}))try{await d.post("/api/users/"+t+"/reject"),y(),m(!1)}catch(n){c.show("Failed to reject: "+(((l=(r=n.response)==null?void 0:r.data)==null?void 0:l.detail)||n.message),"error")}},D=async(t,s)=>{var r,l;if(await h({title:"Delete User",message:"DELETE "+s+"? This cannot be undone.",danger:!0,confirmLabel:"Delete"}))try{await d.delete("/api/users/"+t),y(),m(!1)}catch(n){c.show("Failed to delete user: "+(((l=(r=n.response)==null?void 0:r.data)==null?void 0:l.detail)||n.message),"error")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(V,{label:"Administration",title:"User Management",description:"Manage admin and applicant accounts",action:e.jsxs("button",{onClick:()=>j(!0),className:"sexy-btn px-4 py-2 flex items-center gap-2",style:{background:a.purplePrimary,border:"1px solid "+a.purpleBright,color:"#fff"},children:[e.jsx(H,{className:"w-4 h-4"})," Invite User"]})}),e.jsxs("div",{className:"grid gap-4",style:{gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))"},children:[e.jsx(f,{label:"Total Users",value:g.total,color:a.textPrimary}),e.jsx(f,{label:"Admins",value:g.admins,color:a.purpleBright}),e.jsx(f,{label:"Applicants",value:g.applicants,color:a.accentGreen}),e.jsx(f,{label:"Pending",value:g.pending,color:a.accentAmber}),e.jsx(f,{label:"Inactive",value:g.inactive,color:a.accentRed})]}),e.jsx(B,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(J,{className:"w-5 h-5",style:{color:a.textTertiary}}),e.jsx("input",{type:"text",placeholder:"Search by name, email, or company...",value:b,onChange:t=>z(t.target.value),className:"sexy-input flex-1 px-4 py-3",style:{background:"transparent",border:"1px solid "+a.borderGlass,color:a.textPrimary,outline:"none"}})]})}),e.jsx(B,{children:R?e.jsx("div",{style:{color:a.textTertiary,textAlign:"center",padding:"clamp(16px, 4vw, 40px)"},children:"Loading users..."}):C.length===0?e.jsxs("div",{style:{textAlign:"center",padding:"clamp(24px, 5vw, 60px)"},children:[e.jsx(X,{fill:"currentColor",fillOpacity:.15,strokeWidth:1.8,className:"w-12 h-12 mx-auto mb-4",style:{color:a.textTertiary}}),e.jsx("p",{style:{color:a.textSecondary,marginBottom:"8px"},children:"No users found"}),e.jsx("p",{style:{color:a.textTertiary,fontSize:"14px"},children:x.length===0?"The /api/users/ endpoint may not be configured.":"Try adjusting your search."})]}):e.jsx("div",{className:"space-y-2",children:C.map(t=>{var s,r;return e.jsxs("div",{onClick:()=>{N(t),m(!0)},className:"flex items-center gap-4 p-4 cursor-pointer transition-all",style:{background:"transparent",border:"1px solid "+a.borderGlass},children:[e.jsx("div",{className:"w-10 h-10 flex items-center justify-center flex-shrink-0",style:{background:a.purplePrimary,color:"#fff",fontWeight:"400"},children:((s=t.full_name)==null?void 0:s[0])||((r=t.email)==null?void 0:r[0])||"?"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{style:{color:a.textPrimary,fontWeight:"500"},children:t.full_name||"No Name"}),e.jsx("p",{style:{color:a.textTertiary,fontSize:"13px"},children:t.email}),t.company&&e.jsx("p",{style:{color:a.textTertiary,fontSize:"12px"},children:t.company})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"px-2 py-1 text-xs",style:{background:t.role==="admin"?"rgba(74,61,117,0.10)":t.role==="pending"?"rgba(158,110,18,0.10)":"rgba(0,0,0,0.04)",color:t.role==="admin"?a.purpleBright:t.role==="pending"?a.accentAmber:a.textTertiary,fontFamily:a.mono,textTransform:"uppercase"},children:t.role}),t.role==="pending"&&e.jsxs("div",{className:"flex gap-1",onClick:l=>l.stopPropagation(),children:[e.jsx("button",{onClick:()=>M(t.id,t.email),className:"px-2 py-1 text-xs",style:{background:"rgba(22,135,62,0.10)",color:a.accentGreen,border:"1px solid rgba(22,135,62,0.3)",cursor:"pointer"},children:"Approve"}),e.jsx("button",{onClick:()=>W(t.id,t.email),className:"px-2 py-1 text-xs",style:{background:"transparent",color:a.accentRed,border:"1px solid rgba(0,0,0,0.05)",cursor:"pointer"},children:"Reject"})]}),t.is_active===!1&&e.jsx("span",{className:"px-2 py-1 text-xs",style:{background:"transparent",color:a.accentRed},children:"Inactive"})]})]},t.id||t.email)})})}),G&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{background:"rgba(0,0,0,0.4)"},children:e.jsxs("div",{className:"w-full max-w-md mx-4 p-6",style:{background:"rgba(0,0,0,0.04)",border:"1px solid "+a.borderGlass},children:[e.jsx("h2",{style:{color:a.textPrimary,fontSize:"20px",fontWeight:"400",marginBottom:"24px",textAlign:"center"},children:"Invite New User"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{style:{color:a.textSecondary,fontSize:"12px",display:"block",marginBottom:"6px"},children:"Email *"}),e.jsx("input",{type:"email",value:i.email,onChange:t=>u({...i,email:t.target.value}),placeholder:"user@company.com",className:"sexy-input w-full px-4 py-3",style:{background:"transparent",border:"1px solid "+a.borderGlass,color:a.textPrimary,outline:"none"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:a.textSecondary,fontSize:"12px",display:"block",marginBottom:"6px"},children:"Full Name *"}),e.jsx("input",{type:"text",value:i.full_name,onChange:t=>u({...i,full_name:t.target.value}),placeholder:"John Smith",className:"sexy-input w-full px-4 py-3",style:{background:"transparent",border:"1px solid "+a.borderGlass,color:a.textPrimary,outline:"none"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:a.textSecondary,fontSize:"12px",display:"block",marginBottom:"6px"},children:"Company"}),e.jsx("input",{type:"text",value:i.company,onChange:t=>u({...i,company:t.target.value}),placeholder:"Company name",className:"sexy-input w-full px-4 py-3",style:{background:"transparent",border:"1px solid "+a.borderGlass,color:a.textPrimary,outline:"none"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:a.textSecondary,fontSize:"12px",display:"block",marginBottom:"6px"},children:"Role"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>u({...i,role:"applicant"}),className:"flex-1 px-4 py-3",style:{background:i.role==="applicant"?"rgba(74,61,117,0.10)":"rgba(0,0,0,0.025)",border:"1px solid "+(i.role==="applicant"?a.purpleBright:a.borderGlass),color:i.role==="applicant"?a.purpleBright:a.textTertiary},children:"Applicant"}),e.jsx("button",{onClick:()=>u({...i,role:"admin"}),className:"flex-1 px-4 py-3",style:{background:i.role==="admin"?"rgba(74,61,117,0.10)":"rgba(0,0,0,0.025)",border:"1px solid "+(i.role==="admin"?a.purpleBright:a.borderGlass),color:i.role==="admin"?a.purpleBright:a.textTertiary},children:"Admin"})]})]})]}),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsx("button",{onClick:L,disabled:v,className:"sexy-btn w-full px-4 py-3",style:{background:a.purplePrimary,border:"1px solid "+a.purpleBright,color:"#fff",opacity:v?.7:1},children:v?"Creating...":"Create Account"}),e.jsx("button",{onClick:()=>{j(!1),u({email:"",full_name:"",company:"",role:"applicant"})},className:"w-full px-4 py-3",style:{background:"transparent",border:"none",color:a.textTertiary},children:"Cancel"})]})]})}),F&&o&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{background:"rgba(0,0,0,0.4)"},children:e.jsxs("div",{className:"w-full max-w-md mx-4 p-6",style:{background:"rgba(0,0,0,0.04)",border:"1px solid "+a.borderGlass},children:[e.jsx("h2",{style:{color:a.textPrimary,fontSize:"20px",fontWeight:"400",marginBottom:"24px",textAlign:"center"},children:"Manage User"}),e.jsxs("div",{className:"text-center mb-6 p-4",style:{background:"transparent"},children:[e.jsx("div",{className:"w-16 h-16 flex items-center justify-center mx-auto mb-3",style:{background:a.purplePrimary,color:"#fff",fontSize:"24px",fontWeight:"400"},children:((A=o.full_name)==null?void 0:A[0])||((T=o.email)==null?void 0:T[0])||"?"}),e.jsx("p",{style:{color:a.textPrimary,fontSize:"18px",fontWeight:"500"},children:o.full_name||"No Name"}),e.jsx("p",{style:{color:a.textTertiary,fontSize:"14px"},children:o.email})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{style:{color:a.textTertiary,fontSize:"11px",letterSpacing:"1px",textTransform:"uppercase",display:"block",marginBottom:"8px"},children:"Role"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>S(o.id,"applicant"),className:"flex-1 px-4 py-3",style:{background:o.role==="applicant"?"rgba(74,61,117,0.10)":"rgba(0,0,0,0.025)",border:"1px solid "+(o.role==="applicant"?a.purpleBright:a.borderGlass),color:o.role==="applicant"?a.purpleBright:a.textTertiary},children:"Applicant"}),e.jsx("button",{onClick:()=>S(o.id,"admin"),className:"flex-1 px-4 py-3",style:{background:o.role==="admin"?"rgba(74,61,117,0.10)":"rgba(0,0,0,0.025)",border:"1px solid "+(o.role==="admin"?a.purpleBright:a.borderGlass),color:o.role==="admin"?a.purpleBright:a.textTertiary},children:"Admin"})]})]}),e.jsxs("div",{className:"space-y-2 mb-6",children:[e.jsx("label",{style:{color:a.textTertiary,fontSize:"11px",letterSpacing:"1px",textTransform:"uppercase",display:"block",marginBottom:"8px"},children:"Actions"}),e.jsxs("button",{onClick:()=>I(o.id,o.email),className:"w-full px-4 py-3 flex items-center gap-3",style:{background:"transparent",border:"1px solid "+a.borderGlass,color:a.textSecondary,textAlign:"left"},children:[e.jsx(K,{className:"w-4 h-4",style:{color:a.purpleBright}}),"Reset Password"]}),e.jsx("button",{onClick:()=>E(o.id,o.is_active!==!1),className:"w-full px-4 py-3 flex items-center gap-3",style:{background:"transparent",border:"1px solid "+a.borderGlass,color:o.is_active===!1?a.accentGreen:a.accentRed,textAlign:"left"},children:o.is_active===!1?e.jsxs(e.Fragment,{children:[e.jsx(Q,{fill:"currentColor",fillOpacity:.15,strokeWidth:1.8,className:"w-4 h-4"})," Activate Account"]}):e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"w-4 h-4"})," Deactivate Account"]})}),e.jsxs("button",{onClick:()=>D(o.id,o.email),className:"w-full px-4 py-3 flex items-center gap-3",style:{background:"transparent",border:"1px solid rgba(0,0,0,0.05)",color:a.accentRed,textAlign:"left"},children:[e.jsx(U,{className:"w-4 h-4"})," Delete User"]})]}),e.jsx("button",{onClick:()=>{m(!1),N(null)},className:"w-full px-4 py-3",style:{background:"transparent",border:"none",color:a.textTertiary},children:"Close"})]})})]})}export{re as default};
