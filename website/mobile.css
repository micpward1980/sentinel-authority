/*
 * ═══════════════════════════════════════════════════════════
 * SENTINEL AUTHORITY — Mobile & Responsive Stylesheet
 * ═══════════════════════════════════════════════════════════
 * Single source of truth. All responsive rules live here.
 * No responsive @media in index.html except prefers-reduced-motion.
 *
 * Architecture:
 *   Desktop-first. Progressive overrides at each breakpoint.
 *   Canvas sizing is JS-controlled — CSS only prevents overflow.
 *
 * Breakpoints:
 *   1024px — Tablet landscape
 *    860px — Nav collapse
 *    768px — Tablet portrait
 *    600px — Large phone
 *    480px — Phone
 *    375px — Small phone
 *   Landscape: max-height 500px + orientation: landscape
 *
 * Sections (order matches page flow):
 *   Nav → Hero → ENVELO → Value → Enterprise → Regulators →
 *   Security → Criteria → CAT-72 → Insight → Process → 
 *   Artifacts → Verify → Contact → Footer
 */


/* ═══════════════════════════════════════════════════
   FOUNDATION
   ═══════════════════════════════════════════════════ */
html { overflow-x: hidden; }
body { overflow-x: hidden; -webkit-text-size-adjust: 100%; }


/* ═══════════════════════════════════════════════════
   NAV COLLAPSE (≤860px)
   ═══════════════════════════════════════════════════ */
@media (max-width: 860px) {
  .nav-links { display: none; }
  .nav-toggle { display: block; }
  .nav-drawer { display: block; }
  .drawer-overlay { display: block; }
}


/* ═══════════════════════════════════════════════════
   GRID COLLAPSE — TABLET (≤980px)
   Content grids start stacking earlier than nav
   ═══════════════════════════════════════════════════ */
@media (max-width: 980px) {
  /* 2-col class grids → 1 col */
  .grid-2 { grid-template-columns: 1fr; }
  /* Mechanism diagram → vertical */
  .mechanism { grid-template-columns: 1fr; }
}


/* ═══════════════════════════════════════════════════
   TABLET PORTRAIT (≤768px)
   ═══════════════════════════════════════════════════ */
@media (max-width: 768px) {

  /* ── Foundation ── */
  main, .section, section {
    max-width: 100vw !important;
    overflow-x: hidden !important;
  }
  section, .section {
    padding: 40px 20px !important;
  }

  /* ── Navigation ── */
  .site-header {
    height: 56px;
    padding: 0 12px;
  }
  :root { --nav-height: 56px; }
  .brand-name {
    font-size: 10px !important;
    letter-spacing: 2px !important;
  }
  .nav-links { display: none !important; }
  .nav-badge { display: none !important; }
  /* Innovation Factory logo */
  [href="https://innovationfactory.ca"] {
    display: none !important;
  }

  /* ── Typography ── */
  h1, .hero-content-bottom h1 {
    font-size: clamp(24px, 6.5vw, 36px) !important;
    line-height: 1.15 !important;
  }
  h2, .section-title {
    font-size: clamp(22px, 5vw, 28px) !important;
    line-height: 1.2 !important;
  }
  h3 { font-size: 18px !important; }
  .section-lead {
    font-size: 14px !important;
    line-height: 1.6 !important;
  }

  /* ── Hero ── */
  .hero {
    min-height: auto !important;
    padding-top: 8px !important;
    padding-bottom: 20px !important;
    margin-top: 56px !important;
  }
  .hero-content-bottom {
    padding: 0 16px !important;
    margin-top: -16px !important;
  }
  .hero-content-bottom p:not(.hero-disclaimer) {
    font-size: 13px !important;
    margin-bottom: 10px !important;
  }
  .hero-content-bottom .hero-disclaimer {
    font-size: 7px !important;
  }
  .scroll-line,
  .scroll-indicator-desktop {
    display: none !important;
  }

  /* ── ALL 2-Column Inline Grids → 1 Column ── */
  [style*="grid-template-columns:1fr 1fr"],
  [style*="grid-template-columns: 1fr 1fr"] {
    grid-template-columns: 1fr !important;
  }

  /* ── Multi-Column Grids → 1 Column ── */
  [style*="grid-template-columns: repeat(3"],
  [style*="grid-template-columns: repeat(4"],
  [style*="grid-template-columns: repeat(5"],
  [style*="grid-template-columns:repeat(3"],
  [style*="grid-template-columns:repeat(4"],
  [style*="grid-template-columns:repeat(5"],
  [style*="grid-template-columns:repeat(auto-fit"] {
    grid-template-columns: 1fr !important;
  }

  /* ── Fee Schedule Grid — keep 2-col ── */
  [style*="grid-template-columns:1fr 120px"] {
    grid-template-columns: 1fr 100px !important;
  }

  /* ── Inline width overrides ── */
  [style*="min-width"]:not(input):not(button):not(canvas) {
    min-width: 0 !important;
  }
  [style*="max-width: 700px"],
  [style*="max-width: 800px"],
  [style*="max-width: 900px"] {
    max-width: 100% !important;
  }

  /* ── Inline padding/gap overrides ── */
  [style*="padding: 80px"],
  [style*="padding: 100px"],
  [style*="padding: 120px"] {
    padding: 32px 20px !important;
  }
  [style*="gap: 40px"],
  [style*="gap: 60px"],
  [style*="gap: 80px"] {
    gap: 20px !important;
  }

  /* ── Canvas — let JS handle sizing ── */
  canvas {
    max-width: 100% !important;
    touch-action: pan-y !important;
  }

  /* ── HUD Frames ── */
  .hud-frame {
    padding: 16px !important;
  }
  .hud-desc {
    font-size: 12px !important;
    line-height: 1.65 !important;
  }
  .hud-title {
    font-size: 11px !important;
  }
  .hud-label {
    font-size: 9px !important;
  }

  /* ── Five Gates ── */
  .five-gates-grid {
    grid-template-columns: repeat(2, 1fr) !important;
    gap: 12px !important;
  }
  .five-gates-grid > div:nth-child(5) {
    grid-column: span 2 !important;
    max-width: 60% !important;
    margin: 0 auto !important;
  }

  /* ── Conformance States — vertical flow ── */
  [style*="justify-content: center"][style*="align-items: center"][style*="gap: 8px"][style*="flex-wrap: wrap"] {
    flex-direction: column !important;
    gap: 8px !important;
    align-items: center !important;
  }
  [style*="justify-content: center"][style*="gap: 8px"] > svg[width="24"][height="24"] {
    transform: rotate(90deg) !important;
  }
  [style*="align-items: center"][style*="gap: 12px"][style*="padding: 16px 24px"] {
    width: 200px !important;
    justify-content: flex-start !important;
  }

  /* ── Mechanism / Flow Diagrams ── */
  .mechanism-flow-container,
  .security-flow-container {
    flex-direction: column !important;
    gap: 16px !important;
  }
  .mechanism-connector {
    width: 2px !important;
    height: 40px !important;
  }

  /* ── Timeline ── */
  .timeline-desktop { display: none !important; }
  .timeline-mobile { display: block !important; }

  /* ── Verify Section — button grid ── */
  [style*="display: grid"][style*="grid-template-columns: 1fr 1fr"][style*="gap: 12px"] {
    grid-template-columns: 1fr !important;
  }

  /* ── SVG ── */
  svg:not([width="14"]):not([width="18"]):not([width="24"]):not([width="12"]) {
    max-width: 100% !important;
    height: auto !important;
  }

  /* ── Footer ── */
  .site-footer, footer {
    padding: 32px 20px !important;
  }
  footer [style*="display: grid"] {
    gap: 16px !important;
  }

  /* ── Touch Targets ── */
  .nav-drawer a {
    padding: 14px 20px !important;
    min-height: 44px;
    display: flex;
    align-items: center;
  }
  .hud-row[style*="cursor:pointer"] {
    min-height: 44px;
  }

  /* ── Font size overrides for inline styles ── */
  [style*="font-size: 48px"],
  [style*="font-size: 52px"],
  [style*="font-size: 56px"] {
    font-size: 30px !important;
  }
  [style*="font-size: 36px"],
  [style*="font-size: 40px"] {
    font-size: 24px !important;
  }
}


/* ═══════════════════════════════════════════════════
   LARGE PHONE (≤600px)
   ═══════════════════════════════════════════════════ */
@media (max-width: 600px) {

  /* Hero text tighter */
  .hero-content-bottom h1 {
    font-size: clamp(22px, 6.5vw, 30px) !important;
    margin-bottom: 6px !important;
  }
  .hero-content-bottom p:not(.hero-disclaimer) {
    font-size: 12px !important;
    margin-bottom: 8px !important;
  }

  h1 { font-weight: normal; line-height: 1.0; }

  section, .section {
    padding: 32px 16px !important;
  }

  /* Node boxes in flow diagrams */
  [style*="width: 100px"][style*="height: 100px"] {
    width: 80px !important; height: 80px !important;
  }
  [style*="width: 120px"][style*="height: 120px"] {
    width: 100px !important; height: 100px !important;
  }

  /* Certificate steps stack */
  [style*="display: flex"][style*="gap: 24px"][style*="flex-wrap: wrap"] {
    flex-direction: column !important;
  }

  /* Flow connectors rotate */
  [style*="flex-shrink: 0"][style*="width: 24px"] {
    transform: rotate(90deg);
    margin: 8px 0;
  }

  /* Section padding on sides */
  .section, section {
    padding-left: 16px !important;
    padding-right: 16px !important;
  }

  /* Ticker font */
  .hero .ticker,
  [style*="letter-spacing: 3px"][style*="font-size: 10px"] {
    font-size: 8px !important;
    letter-spacing: 2px !important;
  }
}


/* ═══════════════════════════════════════════════════
   PHONE (≤480px)
   ═══════════════════════════════════════════════════ */
@media (max-width: 480px) {

  .hero-content-bottom {
    padding: 0 12px !important;
    margin-top: -10px !important;
  }
  .hero-content-bottom h1 {
    font-size: clamp(20px, 5.5vw, 26px) !important;
    letter-spacing: -0.01em !important;
  }
  .hero-content-bottom p:not(.hero-disclaimer) {
    font-size: 11px !important;
  }

  .section-title {
    font-size: 21px !important;
  }
  .section-lead {
    font-size: 13px !important;
  }

  .hud-frame { padding: 14px !important; }
  .hud-desc { font-size: 11px !important; line-height: 1.6 !important; }

  /* CTA buttons stack */
  .hero-content-bottom [style*="display: flex"][style*="gap"] {
    flex-direction: column !important;
    align-items: center !important;
    gap: 14px !important;
  }

  /* Button stacking elsewhere */
  [style*="display: flex"][style*="gap: 16px"][style*="justify-content: center"] {
    flex-direction: column !important;
    align-items: center !important;
  }

  /* Five gates: single column */
  .five-gates-grid {
    grid-template-columns: 1fr !important;
  }
  .five-gates-grid > div:nth-child(5) {
    grid-column: span 1 !important;
    max-width: 100% !important;
  }

  /* Fee schedule */
  [style*="grid-template-columns:1fr 120px"] {
    grid-template-columns: 1fr 80px !important;
  }

  /* Smaller node boxes */
  [style*="width: 80px"][style*="height: 80px"] {
    width: 70px !important; height: 70px !important;
  }
}


/* ═══════════════════════════════════════════════════
   SMALL PHONE (≤375px)
   ═══════════════════════════════════════════════════ */
@media (max-width: 375px) {
  .hero-content-bottom h1 {
    font-size: 19px !important;
  }
  .section-title {
    font-size: 19px !important;
  }
  .hud-frame { padding: 12px !important; }
  .hud-desc { font-size: 10px !important; }
  section, .section { padding: 24px 12px !important; }
  .site-header { padding: 0 8px; }
  .brand-name { font-size: 9px !important; }
}


/* ═══════════════════════════════════════════════════
   LANDSCAPE — ALL PHONES
   Height ≤500px means phone in landscape
   ═══════════════════════════════════════════════════ */
@media (max-height: 500px) and (orientation: landscape) {

  /* ── Nav ── */
  .site-header { height: 44px; padding: 0 12px; }
  :root { --nav-height: 44px; }
  .brand-name { font-size: 9px !important; }
  .nav-links { display: none !important; }
  .nav-badge { display: none !important; }
  [href="https://innovationfactory.ca"] { display: none !important; }

  /* ── Hero: minimal chrome ── */
  .hero {
    min-height: auto !important;
    padding: 4px 20px 8px !important;
    margin-top: 44px !important;
  }
  .hero-content-bottom {
    margin-top: -20px !important;
  }
  .hero-content-bottom h1 {
    font-size: clamp(15px, 3.2vw, 22px) !important;
    margin-bottom: 2px !important;
    line-height: 1.1 !important;
  }
  .hero-content-bottom p:not(.hero-disclaimer) {
    font-size: 10px !important;
    margin-bottom: 3px !important;
  }
  .hero-content-bottom .hero-disclaimer {
    display: none !important;
  }
  .hero-content-bottom [style*="display: flex"][style*="gap"] {
    gap: 10px !important;
    flex-direction: row !important;
  }
  .scroll-line, .scroll-indicator-desktop { display: none !important; }

  /* ── Sections: compressed ── */
  section, .section {
    padding: 16px 20px !important;
  }
  .section-title {
    font-size: 18px !important;
    margin-bottom: 4px !important;
  }
  .section-lead {
    font-size: 11px !important;
    margin-bottom: 4px !important;
  }

  /* ── HUD ── */
  .hud-frame { padding: 8px !important; }
  .hud-desc { font-size: 9px !important; line-height: 1.4 !important; }
  .hud-title { font-size: 9px !important; }
  .hud-label { font-size: 8px !important; }

  /* ── Grids: KEEP 2-col in landscape (wide screen) ── */
  [style*="grid-template-columns:1fr 1fr"],
  [style*="grid-template-columns: 1fr 1fr"] {
    grid-template-columns: 1fr 1fr !important;
  }
  [style*="grid-template-columns:repeat(auto-fit"] {
    grid-template-columns: repeat(2, 1fr) !important;
  }

  /* ── Five gates: 3-col ── */
  .five-gates-grid {
    grid-template-columns: repeat(3, 1fr) !important;
    gap: 6px !important;
  }
  .five-gates-grid > div:nth-child(n) {
    grid-column: span 1 !important;
    max-width: 100% !important;
  }

  /* ── Conformance states: horizontal (room in landscape) ── */
  [style*="justify-content: center"][style*="align-items: center"][style*="gap: 8px"][style*="flex-wrap: wrap"] {
    flex-direction: row !important;
    flex-wrap: nowrap !important;
    gap: 4px !important;
  }
  [style*="justify-content: center"][style*="gap: 8px"] > svg[width="24"][height="24"] {
    transform: none !important;
  }
  [style*="align-items: center"][style*="gap: 12px"][style*="padding: 16px 24px"] {
    width: auto !important;
    padding: 8px 12px !important;
  }

  /* ── Buttons compact ── */
  .btn,
  a[style*="padding:14px"],
  a[style*="padding: 14px"] {
    padding: 6px 14px !important;
    font-size: 9px !important;
  }

  /* ── Canvas: no overflow ── */
  canvas { max-width: 100% !important; touch-action: pan-y !important; }
}


/* ═══════════════════════════════════════════════════
   LANDSCAPE — VERY SHORT (≤400px height)
   iPhone SE, older Androids rotated
   ═══════════════════════════════════════════════════ */
@media (max-height: 400px) and (orientation: landscape) {
  .hero { padding: 2px 16px 4px !important; }
  .hero-content-bottom h1 { font-size: 14px !important; }
  .hero-content-bottom p:not(.hero-disclaimer) { font-size: 9px !important; }
  section, .section { padding: 12px 16px !important; }
  .section-title { font-size: 16px !important; }
  .hud-frame { padding: 6px !important; }
}


/* ═══════════════════════════════════════════════════
   TOUCH DEVICES
   ═══════════════════════════════════════════════════ */
@media (hover: none) and (pointer: coarse) {
  /* 44px minimum touch targets */
  .nav-drawer a,
  .hud-row[style*="cursor"],
  button,
  [role="button"] {
    min-height: 44px;
  }
  /* Disable hover transforms on touch */
  .hud-frame:hover,
  .hud-row:hover {
    transform: none !important;
  }
  /* Prevent canvas from eating scroll gestures */
  canvas {
    touch-action: pan-y !important;
  }
}


/* ═══════════════════════════════════════════════════
   PRINT
   ═══════════════════════════════════════════════════ */
@media print {
  canvas { display: none !important; }
  .site-header, .nav-drawer, .drawer-overlay, .grid-overlay { display: none !important; }
  section { page-break-inside: avoid; padding: 20px 0 !important; background: white !important; }
  .hud-frame { border: 1px solid #ccc !important; background: white !important; }
  body { background: white !important; color: black !important; }
}
