#!/usr/bin/env python3
"""Fix earth background - show only outside the animation area"""

filepath = "index.html"

with open(filepath, 'r') as f:
    content = f.read()

# Remove old earth CSS
old_earth = '''
    /* Flat world map background in hero */
    .hero {
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1000 500'%3E%3Cpath fill='rgba(157,140,207,0.03)' d='M473 83c-11-4-26-5-39-3-5 1-9 3-12 6-2 2-3 5-2 8 2 5 9 7 15 8 13 2 27 0 39-5 5-2 10-5 12-9 1-2 0-4-2-5-3-1-7-1-11 0zm-193 7c-8 2-15 6-20 12-3 4-5 9-4 14 1 4 4 7 8 9 8 4 18 3 27 0 11-3 21-10 27-19 3-4 4-9 2-13-2-3-6-5-10-5-10-1-20 0-30 2zm367-12c-14-1-28 2-40 9-6 4-12 9-14 16-2 5-1 11 3 15 6 6 16 7 25 6 16-2 31-9 43-19 6-5 11-11 12-18 1-5-2-9-7-10-7-1-15 0-22 1zM247 138c-15 4-28 13-37 25-5 6-8 14-7 21 1 6 5 11 11 14 10 5 23 4 34 0 18-6 34-18 44-33 5-7 8-16 6-24-2-6-7-11-14-12-12-2-25 3-37 9zm455-19c-12 6-22 16-28 28-4 7-6 15-4 23 2 6 7 11 13 13 11 3 23-1 33-7 15-10 27-25 32-42 3-8 3-17-1-24-3-5-9-8-16-7-10 1-20 8-29 16zM150 218c-10 9-17 22-19 35-1 8 0 16 5 22 4 5 11 8 18 7 12-1 23-9 31-19 12-15 19-34 19-53 0-9-3-18-9-24-5-4-12-5-18-3-11 4-19 15-27 28v7zm596-48c-8 14-12 31-10 47 1 9 5 18 12 24 5 4 12 6 19 4 11-3 20-13 25-24 9-17 12-37 8-56-2-9-7-18-14-23-6-4-13-4-19-1-10 5-16 16-21 29zm-490 82c-5 14-5 30 0 44 3 8 8 16 16 20 6 3 13 3 19 0 10-6 16-17 18-29 4-19 1-40-9-56-5-8-12-14-21-16-6-1-13 1-17 5-8 7-11 19-6 32zm389-25c4 19 14 36 28 49 7 7 16 12 25 12 7 0 14-4 17-10 6-10 4-24-2-35-10-18-26-33-45-41-9-4-19-5-27-2-6 2-10 8-10 15 1 12 8 24 14 12zm-257 67c2 17 10 33 22 45 7 6 15 11 24 11 7 0 13-4 16-10 5-11 2-25-5-36-12-17-30-30-50-36-10-3-20-3-28 1-6 3-9 9-8 16 2 12 12 22 29 9zm142-4c12 17 30 30 50 36 10 3 20 3 28-1 6-3 9-9 8-16-2-12-12-22-29-9-2-17-10-33-22-45-7-6-15-11-24-11-7 0-13 4-16 10-5 11-2 25 5 36zm-70 52c8 14 20 26 35 33 8 4 17 6 25 4 6-2 11-7 12-13 2-11-4-23-14-31-15-13-35-21-55-21-10 0-20 3-26 9-5 5-6 12-3 18 4 10 14 17 26 1zm279-181c-12 11-20 27-22 43-1 9 1 18 6 25 4 5 11 8 18 7 12-2 22-12 28-24 10-18 13-40 8-60-2-10-8-19-16-24-6-4-14-4-20 0-9 6-14 18-2 33zM87 288c-5 17-4 36 3 52 4 9 10 17 19 21 7 3 15 2 21-3 10-8 14-22 13-35-2-21-13-41-29-55-8-7-18-11-28-10-8 1-14 6-15 14-2 13 5 26 16 16zm726-30c2 21 13 41 29 55 8 7 18 11 28 10 8-1 14-6 15-14 2-13-5-26-16-16 5-17 4-36-3-52-4-9-10-17-19-21-7-3-15-2-21 3-10 8-14 22-13 35zM198 374c3 15 12 29 25 38 7 5 15 8 23 7 6-1 12-5 14-11 4-11-1-24-10-33-14-14-34-23-54-24-10-1-20 2-27 8-5 5-6 12-3 18 5 11 17 16 32-3zm509 3c14 14 34 23 54 24 10 1 20-2 27-8 5-5 6-12 3-18-5-11-17-16-32 3-3-15-12-29-25-38-7-5-15-8-23-7-6 1-12 5-14 11-4 11 1 24 10 33zM294 430c9 11 22 19 36 22 8 2 16 1 23-3 5-3 9-9 9-15 0-12-9-22-21-28-18-9-39-11-58-6-10 3-18 8-23 16-3 6-3 13 2 18 7 8 19 9 32-4zm321 1c18 9 39 11 58 6 10-3 18-8 23-16 3-6 3-13-2-18-7-8-19-9-32 4-9-11-22-19-36-22-8-2-16-1-23 3-5 3-9 9-9 15 0 12 9 22 21 28zM405 460c12 6 26 8 39 5 7-2 14-5 18-11 3-5 3-11 0-16-6-9-18-13-30-13-18 0-36 7-49 18-7 6-12 13-13 21-1 6 2 12 8 15 9 5 21 2 27-19zm105 0c18 0 36-7 49-18 7-6 12-13 13-21 1-6-2-12-8-15-9-5-21-2-27 19-12-6-26-8-39-5-7 2-14 5-18 11-3 5-3 11 0 16 6 9 18 13 30 13z'/%3E%3C/svg%3E");
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
    }
'''

content = content.replace(old_earth, '')

# New approach: earth bg as a separate layer that fades out in center
earth_css = '''
    /* Flat world map background in hero - outside animation only */
    .hero-earth-bg {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1000 500'%3E%3Cpath fill='rgba(157,140,207,0.04)' d='M473 83c-11-4-26-5-39-3-5 1-9 3-12 6-2 2-3 5-2 8 2 5 9 7 15 8 13 2 27 0 39-5 5-2 10-5 12-9 1-2 0-4-2-5-3-1-7-1-11 0zm-193 7c-8 2-15 6-20 12-3 4-5 9-4 14 1 4 4 7 8 9 8 4 18 3 27 0 11-3 21-10 27-19 3-4 4-9 2-13-2-3-6-5-10-5-10-1-20 0-30 2zm367-12c-14-1-28 2-40 9-6 4-12 9-14 16-2 5-1 11 3 15 6 6 16 7 25 6 16-2 31-9 43-19 6-5 11-11 12-18 1-5-2-9-7-10-7-1-15 0-22 1zM247 138c-15 4-28 13-37 25-5 6-8 14-7 21 1 6 5 11 11 14 10 5 23 4 34 0 18-6 34-18 44-33 5-7 8-16 6-24-2-6-7-11-14-12-12-2-25 3-37 9zm455-19c-12 6-22 16-28 28-4 7-6 15-4 23 2 6 7 11 13 13 11 3 23-1 33-7 15-10 27-25 32-42 3-8 3-17-1-24-3-5-9-8-16-7-10 1-20 8-29 16zM150 218c-10 9-17 22-19 35-1 8 0 16 5 22 4 5 11 8 18 7 12-1 23-9 31-19 12-15 19-34 19-53 0-9-3-18-9-24-5-4-12-5-18-3-11 4-19 15-27 28v7zm596-48c-8 14-12 31-10 47 1 9 5 18 12 24 5 4 12 6 19 4 11-3 20-13 25-24 9-17 12-37 8-56-2-9-7-18-14-23-6-4-13-4-19-1-10 5-16 16-21 29zm-490 82c-5 14-5 30 0 44 3 8 8 16 16 20 6 3 13 3 19 0 10-6 16-17 18-29 4-19 1-40-9-56-5-8-12-14-21-16-6-1-13 1-17 5-8 7-11 19-6 32zm389-25c4 19 14 36 28 49 7 7 16 12 25 12 7 0 14-4 17-10 6-10 4-24-2-35-10-18-26-33-45-41-9-4-19-5-27-2-6 2-10 8-10 15 1 12 8 24 14 12zm-257 67c2 17 10 33 22 45 7 6 15 11 24 11 7 0 13-4 16-10 5-11 2-25-5-36-12-17-30-30-50-36-10-3-20-3-28 1-6 3-9 9-8 16 2 12 12 22 29 9zm142-4c12 17 30 30 50 36 10 3 20 3 28-1 6-3 9-9 8-16-2-12-12-22-29-9-2-17-10-33-22-45-7-6-15-11-24-11-7 0-13 4-16 10-5 11-2 25 5 36zm-70 52c8 14 20 26 35 33 8 4 17 6 25 4 6-2 11-7 12-13 2-11-4-23-14-31-15-13-35-21-55-21-10 0-20 3-26 9-5 5-6 12-3 18 4 10 14 17 26 1zm279-181c-12 11-20 27-22 43-1 9 1 18 6 25 4 5 11 8 18 7 12-2 22-12 28-24 10-18 13-40 8-60-2-10-8-19-16-24-6-4-14-4-20 0-9 6-14 18-2 33zM87 288c-5 17-4 36 3 52 4 9 10 17 19 21 7 3 15 2 21-3 10-8 14-22 13-35-2-21-13-41-29-55-8-7-18-11-28-10-8 1-14 6-15 14-2 13 5 26 16 16zm726-30c2 21 13 41 29 55 8 7 18 11 28 10 8-1 14-6 15-14 2-13-5-26-16-16 5-17 4-36-3-52-4-9-10-17-19-21-7-3-15-2-21 3-10 8-14 22-13 35zM198 374c3 15 12 29 25 38 7 5 15 8 23 7 6-1 12-5 14-11 4-11-1-24-10-33-14-14-34-23-54-24-10-1-20 2-27 8-5 5-6 12-3 18 5 11 17 16 32-3zm509 3c14 14 34 23 54 24 10 1 20-2 27-8 5-5 6-12 3-18-5-11-17-16-32 3-3-15-12-29-25-38-7-5-15-8-23-7-6 1-12 5-14 11-4 11 1 24 10 33zM294 430c9 11 22 19 36 22 8 2 16 1 23-3 5-3 9-9 9-15 0-12-9-22-21-28-18-9-39-11-58-6-10 3-18 8-23 16-3 6-3 13 2 18 7 8 19 9 32-4zm321 1c18 9 39 11 58 6 10-3 18-8 23-16 3-6 3-13-2-18-7-8-19-9-32 4-9-11-22-19-36-22-8-2-16-1-23 3-5 3-9 9-9 15 0 12 9 22 21 28zM405 460c12 6 26 8 39 5 7-2 14-5 18-11 3-5 3-11 0-16-6-9-18-13-30-13-18 0-36 7-49 18-7 6-12 13-13 21-1 6 2 12 8 15 9 5 21 2 27-19zm105 0c18 0 36-7 49-18 7-6 12-13 13-21 1-6-2-12-8-15-9-5-21-2-27 19-12-6-26-8-39-5-7 2-14 5-18 11-3 5-3 11 0 16 6 9 18 13 30 13z'/%3E%3C/svg%3E");
      background-size: 120% auto;
      background-position: center;
      background-repeat: no-repeat;
      z-index: 0;
      pointer-events: none;
      -webkit-mask-image: radial-gradient(ellipse at center, transparent 30%, black 60%);
      mask-image: radial-gradient(ellipse at center, transparent 30%, black 60%);
    }
'''

if 'hero-earth-bg' not in content:
    content = content.replace('.hero-eye {', earth_css + '\n    .hero-eye {')
    print("Added earth bg CSS")

# Add the div to the hero section
hero_earth_div = '      <!-- Earth background layer -->\n      <div class="hero-earth-bg"></div>\n'
if 'hero-earth-bg"></div>' not in content:
    content = content.replace('<canvas id="hero-canvas"', hero_earth_div + '      <canvas id="hero-canvas"')
    print("Added earth bg div")

with open(filepath, 'w') as f:
    f.write(content)

print("Done!")
